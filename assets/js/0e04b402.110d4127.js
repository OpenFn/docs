"use strict";(self.webpackChunk_openfn_docs=self.webpackChunk_openfn_docs||[]).push([[2782],{19063:(e,r,a)=>{a.r(r),a.d(r,{assets:()=>s,contentTitle:()=>o,default:()=>c,frontMatter:()=>_,metadata:()=>i,toc:()=>l});var n=a(58168),t=(a(96540),a(15680));const _={title:"Upsert Aggregate Service Referrals",sidebar_label:"Upsert Aggregate Service Referrals",id:"Upsert-Aggregate-Service-Referrals-2021-04-30",keywords:["library","job","expression","salesforce","dataValue","field","fields","relationship","upsert"]},o=void 0,i={unversionedId:"library/jobs/auto/Upsert-Aggregate-Service-Referrals-2021-04-30",id:"library/jobs/auto/Upsert-Aggregate-Service-Referrals-2021-04-30",title:"Upsert Aggregate Service Referrals",description:"This job was provided by an OpenFn.org user via the job library API.",source:"@site/adaptors/library/jobs/auto/Upsert-Aggregate-Service-Referrals-2021-04-30.md",sourceDirName:"library/jobs/auto",slug:"/library/jobs/auto/Upsert-Aggregate-Service-Referrals-2021-04-30",permalink:"/adaptors/library/jobs/auto/Upsert-Aggregate-Service-Referrals-2021-04-30",draft:!1,tags:[],version:"current",frontMatter:{title:"Upsert Aggregate Service Referrals",sidebar_label:"Upsert Aggregate Service Referrals",id:"Upsert-Aggregate-Service-Referrals-2021-04-30",keywords:["library","job","expression","salesforce","dataValue","field","fields","relationship","upsert"]},sidebar:"adaptors",previous:{title:"Upsert ART Adherence Self-Reporting Tool",permalink:"/adaptors/library/jobs/auto/Upsert-ART-Adherence-Self-Reporting-Tool-2021-04-30"},next:{title:"Risk and Vulnerability Assessment",permalink:"/adaptors/library/jobs/auto/Risk-and-Vulnerability-Assessment-2021-05-27"}},s={},l=[{value:"Metadata",id:"metadata",level:2},{value:"Key Functions",id:"key-functions",level:2},{value:"Expression",id:"expression",level:2}],f={toc:l},d="wrapper";function c(e){let{components:r,...a}=e;return(0,t.yg)(d,(0,n.A)({},f,a,{components:r,mdxType:"MDXLayout"}),(0,t.yg)("em",null,"This job was provided by an OpenFn.org user via the job library API."),(0,t.yg)("h2",{id:"metadata"},"Metadata"),(0,t.yg)("ul",null,(0,t.yg)("li",{parentName:"ul"},"Name: Upsert Aggregate Service Referrals"),(0,t.yg)("li",{parentName:"ul"},"Adaptor: ",(0,t.yg)("a",{parentName:"li",href:"https://www.github.com/openfn/language-salesforce"},(0,t.yg)("inlineCode",{parentName:"a"},"@openfn/language-salesforce"))),(0,t.yg)("li",{parentName:"ul"},"Adaptor Version: ",(0,t.yg)("a",{parentName:"li",href:"https://www.github.com/openfn/language-salesforce/releases/tag/v2.7.4"},(0,t.yg)("inlineCode",{parentName:"a"},"v2.7.4"))),(0,t.yg)("li",{parentName:"ul"},"Created about 4 years ago"),(0,t.yg)("li",{parentName:"ul"},"Updated 4 months ago"),(0,t.yg)("li",{parentName:"ul"},"Score: ",(0,t.yg)("b",null,"0")," (an ",(0,t.yg)("a",{parentName:"li",href:"/adaptors/library/#library-scores"},"indicator")," of how useful this job may be)")),(0,t.yg)("h2",{id:"key-functions"},"Key Functions"),(0,t.yg)("p",null,(0,t.yg)("inlineCode",{parentName:"p"},"dataValue"),", ",(0,t.yg)("inlineCode",{parentName:"p"},"field"),", ",(0,t.yg)("inlineCode",{parentName:"p"},"fields"),", ",(0,t.yg)("inlineCode",{parentName:"p"},"relationship"),", ",(0,t.yg)("inlineCode",{parentName:"p"},"upsert")),(0,t.yg)("h2",{id:"expression"},"Expression"),(0,t.yg)("pre",null,(0,t.yg)("code",{parentName:"pre",className:"language-js"},"// Push to production\nupsert(\n  'GRS_Referral_Agg__c',\n  'CommCare_Ext_ID__c',\n  fields(\n    relationship(\n      'SiteName__r',\n      'CommCare_Ext_ID__c',\n      dataValue('form.general_referral_information.event_information.site')\n    ),\n    field('CommCare_Ext_ID__c', dataValue('form.general_referral_information.event_information.site')),\n    //TO DO\n    //field('Business_Unit__c', dataValue('form.general_referral_information.event_information.business_unit')),\n    field('Business_Unit__c', state => {\n      const bu = dataValue('form.general_referral_information.event_information.business_unit')(state); \n      return bu==='65680f0c4c144b03ad0f86bdc46c1ebc' ? 'GRS Zambia' : \n      bu==='04d98397e28046118fade28ced6b65cb' ? 'GRS Zimbabwe' : \n      bu==='ed125ab19ec34aacab79585e59eb76f4' ? 'GRS Partnerships': undefined ; \n    }),\n    relationship(\n        //Attendance looks up to Event via the intervention_name\n        'Events__r',\n        'CommCare_Ext_ID__c',\n        dataValue('form.general_referral_information.event_information.event_name')\n      ),\n    field('Type_of_Referral__c', dataValue('form.general_referral_information.type_of_referral')),\n    field(\n      'Enter_Partner_s_Name__c',\n      dataValue('form.general_referral_information.partner_or_organization_referred_to')\n    ),\n    field('Males_Referred_HIV_Testing__c', dataValue('form.hivsti_services.males_referred_for_hiv_testing')),\n    field('Males_referred_for_STI_Screening__c', dataValue('form.hivsti_services.males_referred_for_sti_screening')),\n    field('Males_Referred_for_PEP__c', dataValue('form.hivsti_services.males_referred_for_pep')),\n    field('Males_Referred_for_PrEP__c', dataValue('form.hivsti_services.males_referred_for_prep')),\n    field('Males_Referred_for_VMMC__c', dataValue('form.hivsti_services.males_referred_for_vmmc')),\n    field('Females_Referred_for_HIV_Testing__c', dataValue('form.hivsti_services.females_referred_for_hiv_testing')),\n    field(\n      'Females_Referred_for_STI_Screening__c',\n      dataValue('form.hivsti_services.females_referred_for_sti_screening')\n    ),\n    field('Date_Referred__c', dataValue('form.general_referral_information.date_referred')),\n    field('Females_Referred_for_PEP__c', dataValue('form.hivsti_services.females_referred_for_pep')),\n    field('Females_Referred_for_PrEP__c', dataValue('form.hivsti_services.females_referred_for_prep')),\n    field('Males_Referred_for_ART__c', dataValue('form.art_services.males_referred_for_art')),\n    field('Males_Referred_for_SKILLZ_Club__c', dataValue('form.art_services.males_referred_for_skillz__club')),\n    field('Females_Referred_for_ART__c', dataValue('form.art_services.females_referred_for_art')),\n    field('Females_Referred_SKILLZ_Club__c', dataValue('form.art_services.females_referred_for_skillz__club')),\n    field('Females_Referred_for_PMTCT__c', dataValue('form.art_services.females_referred_for_pmtct')),\n    \n    field(\n      'Males_Referred_for_Psycho_Social_Support__c',\n      dataValue('form.psycho_-_social_services.males_referred_for_psycho-social_support')\n    ),\n    field(\n      'Females_Referred_Psycho_Social_Support__c',\n      dataValue('form.psycho_-_social_services.females_referred_for_psycho-social_support')\n    ),\n    field('Males_Referred_for_TB_Screening__c', dataValue('form.tb_services.males_referred_for_tb_screening')),\n    field('Females_Referred_for_TB_Screening__c', dataValue('form.tb_services.females_referred_for_rb_screening')),\n    field(\n      'Number_of_Male_Condoms_distributed__c',\n      dataValue('form.condom_distributions.number_of_male_condoms_distributed')\n    ),\n    field('Number_of_Male_Condoms_Accessed__c', dataValue('form.condom_distributions.number_of_male_condoms_accessed')),\n    field(\n      'Number_of_Female_Condoms_distributed__c',\n      dataValue('form.condom_distributions.number_of_female_condoms_distributed')\n    ),\n    field(\n      'Number_of_Female_Condoms_Accessedx__c',\n      dataValue('form.condom_distributions.number_of_female_condoms_accessed')\n    ),\n    field(\n      'Females_Referred_for_Family_Planning__c',\n      dataValue('form.other_srhr_services.females_referred_for_family_planning')\n    ),\n    field(\n      'Females_Referred_for_Cervical_Cancer__c',\n      dataValue('form.other_srhr_services.females_referred_for_cervical_cancer')\n    ),\n    field('Females_Referred_for_Antenatal__c', dataValue('form.other_srhr_services.females_referred_for_antenatal')),\n    field(\n      'Males_Referred_for_Malaria_Testing__c',\n      dataValue('form.other_referral_services.males_referred_for_malaria_testing')\n    ),\n    field('Males_Referred_for_GBV__c', dataValue('form.other_referral_services.males_referred_for_gbv')),\n    field(\n      'Females_Referred_for_Malaria_Testing__c',\n      dataValue('form.other_referral_services.females_referred_for_malaria_testing')\n    ),\n    field('Females_Referred_for_GBV__c', dataValue('form.other_referral_services.females_referred_for_gbv')),\n    field(\n      'Females_Referred_for_HPV_Vaccine__c',\n      dataValue('form.other_referral_services.females_referred_for_hpv_vaccine')\n    )\n  )\n);\n")))}c.isMDXComponent=!0},15680:(e,r,a)=>{a.d(r,{xA:()=>f,yg:()=>u});var n=a(96540);function t(e,r,a){return r in e?Object.defineProperty(e,r,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[r]=a,e}function _(e,r){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),a.push.apply(a,n)}return a}function o(e){for(var r=1;r<arguments.length;r++){var a=null!=arguments[r]?arguments[r]:{};r%2?_(Object(a),!0).forEach((function(r){t(e,r,a[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):_(Object(a)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(a,r))}))}return e}function i(e,r){if(null==e)return{};var a,n,t=function(e,r){if(null==e)return{};var a,n,t={},_=Object.keys(e);for(n=0;n<_.length;n++)a=_[n],r.indexOf(a)>=0||(t[a]=e[a]);return t}(e,r);if(Object.getOwnPropertySymbols){var _=Object.getOwnPropertySymbols(e);for(n=0;n<_.length;n++)a=_[n],r.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(t[a]=e[a])}return t}var s=n.createContext({}),l=function(e){var r=n.useContext(s),a=r;return e&&(a="function"==typeof e?e(r):o(o({},r),e)),a},f=function(e){var r=l(e.components);return n.createElement(s.Provider,{value:r},e.children)},d="mdxType",c={inlineCode:"code",wrapper:function(e){var r=e.children;return n.createElement(n.Fragment,{},r)}},m=n.forwardRef((function(e,r){var a=e.components,t=e.mdxType,_=e.originalType,s=e.parentName,f=i(e,["components","mdxType","originalType","parentName"]),d=l(a),m=t,u=d["".concat(s,".").concat(m)]||d[m]||c[m]||_;return a?n.createElement(u,o(o({ref:r},f),{},{components:a})):n.createElement(u,o({ref:r},f))}));function u(e,r){var a=arguments,t=r&&r.mdxType;if("string"==typeof e||t){var _=a.length,o=new Array(_);o[0]=m;var i={};for(var s in r)hasOwnProperty.call(r,s)&&(i[s]=r[s]);i.originalType=e,i[d]="string"==typeof e?e:t,o[1]=i;for(var l=2;l<_;l++)o[l]=a[l];return n.createElement.apply(null,o)}return n.createElement.apply(null,a)}m.displayName="MDXCreateElement"}}]);