"use strict";(self.webpackChunk_openfn_docs=self.webpackChunk_openfn_docs||[]).push([[92195],{28453:(e,n,s)=>{s.d(n,{R:()=>a,x:()=>r});var t=s(96540);const i={},o=t.createContext(i);function a(e){const n=t.useContext(o);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:a(e.components),t.createElement(o.Provider,{value:n},e.children)}},67936:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>l,contentTitle:()=>r,default:()=>p,frontMatter:()=>a,metadata:()=>t,toc:()=>d});const t=JSON.parse('{"id":"packages/ibipimo-readme","title":"ibipimo developer readme","description":"Source//github.com/OpenFn/adaptors/tree/main/packages/ibipimo","source":"@site/adaptors/packages/ibipimo-readme.md","sourceDirName":"packages","slug":"/packages/ibipimo-readme","permalink":"/adaptors/packages/ibipimo-readme","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"title":"ibipimo developer readme","id":"ibipimo-readme","keywords":["adaptor","readme","ibipimo"]},"sidebar":"adaptors","previous":{"title":"Changelog","permalink":"/adaptors/packages/ibipimo-changelog"},"next":{"title":"Functions","permalink":"/adaptors/packages/ihris-docs"}}');var i=s(74848),o=s(28453);const a={title:"ibipimo developer readme",id:"ibipimo-readme",keywords:["adaptor","readme","ibipimo"]},r="ibipimo Adaptor developer README.md",l={},d=[{value:"Documentation",id:"documentation",level:2},{value:"Overview",id:"overview",level:2},{value:"Authentication",id:"authentication",level:2},{value:"Configuration",id:"configuration",level:3},{value:"Usage Examples",id:"usage-examples",level:2},{value:"Post Viral Load Request",id:"post-viral-load-request",level:3},{value:"Get Viral Load Results",id:"get-viral-load-results",level:3},{value:"Generic Post Request",id:"generic-post-request",level:3},{value:"Generic Post Request",id:"generic-post-request-1",level:3},{value:"Avanced processing",id:"avanced-processing",level:3},{value:"Error Handling",id:"error-handling",level:2},{value:"Development",id:"development",level:2},{value:"Installation and testing",id:"installation-and-testing",level:2},{value:"1. Install dependencies",id:"1-install-dependencies",level:3},{value:"2. Local testing",id:"2-local-testing",level:3},{value:"tmp files",id:"tmp-files",level:4},{value:"Test with OpenFn CLI (if installed)",id:"test-with-openfn-cli-if-installed",level:4}];function c(e){const n={a:"a",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,o.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"ibipimo-adaptor-developer-readmemd",children:"ibipimo Adaptor developer README.md"})}),"\n",(0,i.jsxs)(n.p,{children:["Source: ",(0,i.jsx)(n.a,{href:"https://github.com/OpenFn/adaptors/tree/main/packages/ibipimo",children:"https://github.com/OpenFn/adaptors/tree/main/packages/ibipimo"})]}),"\n",(0,i.jsxs)(n.h1,{id:"language-ibipimo-",children:["language-ibipimo ",(0,i.jsx)("img",{src:"./assets/square.png",width:"30",height:"30"})]}),"\n",(0,i.jsxs)(n.p,{children:["An OpenFn ",(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.em,{children:"adaptor"})})," for building integration jobs for use with the IBIPIMO\nlaboratory system API."]}),"\n",(0,i.jsx)(n.h2,{id:"documentation",children:"Documentation"}),"\n",(0,i.jsxs)(n.p,{children:["View the ",(0,i.jsx)(n.a,{href:"https://docs.openfn.org/adaptors/packages/ibipimo-docs",children:"docs site"})," for\nfull technical documentation."]}),"\n",(0,i.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,i.jsx)(n.p,{children:"The IBIPIMO adaptor allows you to interact with the IBIPIMO laboratory system\nto:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Post viral load test requests"}),"\n",(0,i.jsx)(n.li,{children:"Retrieve viral load test results"}),"\n",(0,i.jsx)(n.li,{children:"And do other get and post request to IBIPIMO"}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"authentication",children:"Authentication"}),"\n",(0,i.jsxs)(n.p,{children:["This adaptor uses ",(0,i.jsx)(n.strong,{children:"Bearer token authentication"}),". You need to provide:"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"baseUrl"}),": The base URL of the IBIPIMO API server (e.g.,\n",(0,i.jsx)(n.code,{children:"https://demo.ibipimo.org"}),")"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"apiToken"}),": Your IBIPIMO API access token"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"configuration",children:"Configuration"}),"\n",(0,i.jsxs)(n.p,{children:["All required and optional properties for state.configuration are defined in the\nofficial\n",(0,i.jsx)(n.a,{href:"https://docs.openfn.org/adaptors/packages/ibipimo-configuration-schema",children:"configuration-schema"}),"."]}),"\n",(0,i.jsx)(n.p,{children:"Example configuration:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n  "baseUrl": "https://demo.ibipimo.org",\n  "apiToken": "your_access_token_here"\n}\n'})}),"\n",(0,i.jsx)(n.h2,{id:"usage-examples",children:"Usage Examples"}),"\n",(0,i.jsx)(n.h3,{id:"post-viral-load-request",children:"Post Viral Load Request"}),"\n",(0,i.jsx)(n.p,{children:"Post a new viral load test request to the IBIPIMO system:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-js",children:"postViralLoadRequest({\n  siteid: '77889900',\n  samples: [\n    {\n      sidainfo_uid: '147460',\n      p_code: '000003',\n      p_name: 'Magara',\n      p_prename: 'Mahire',\n      p_sex: 'M',\n      p_dob: '1950-01-15',\n      p_telephone: '79932635',\n      female_status: 'na',\n      colline: null,\n      arv_start_date: '2006-09-21',\n      p_stade_clinique: '4',\n      p_ligne_therap: '1',\n      reason_vl: 'suspicion_echec',\n      on_arv: '1',\n      sample_type: null,\n      date_blood_taken: '2024-04-15 11:49:00',\n      place_blood_taken: 'CDS Training',\n      blood_taken_by: null,\n      prescription_by: null,\n      contact_sender: null,\n      blood_received_by: '',\n      province_id: '017BD',\n      commune_id: '003BDI017001',\n      arv_combination_id: 'TDF(300)/3TC(300)/DTG(50)',\n      date_last_vl: null,\n      last_vl_copies: '-1',\n      site: '77889900',\n      dateprelevement: '2024-04-15',\n      sidainfo_siteid: '77889900',\n      hf_district: null,\n      hf_province: null,\n    },\n  ],\n});\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Success Response (201):"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n  "data": {\n    "errors": [],\n    "saved_viral_load_samples": [\n      {\n        "id": 830139,\n        "s_uid": "634W",\n        "siteid": "22222222",\n        "codepatient": "000010",\n        "date_prelevement": "15/04/2024 11:49:00",\n        "updated_at": "2026-02-18 12:52:51"\n      }\n    ]\n  },\n  "references": [{}],\n  "response": {\n    "url": "https://demo.ibipimo.org/api/v1/post-viral-load-requests",\n    "method": "POST",\n    "statusCode": 201,\n    "statusMessage": "Created",\n    "headers": {\n      "date": "Fri, 20 Feb 2026 15:12:40 GMT",\n      "server": "Apache",\n      "cache-control": "no-cache, private",\n      "access-control-allow-origin": "*",\n      "vary": "Authorization,User-Agent",\n      "upgrade": "h2",\n      "connection": "Upgrade, Keep-Alive",\n      "keep-alive": "timeout=5, max=100",\n      "transfer-encoding": "chunked",\n      "content-type": "application/json"\n    },\n    "duration": 5555\n  }\n}\n'})}),"\n",(0,i.jsx)(n.h3,{id:"get-viral-load-results",children:"Get Viral Load Results"}),"\n",(0,i.jsx)(n.p,{children:"Retrieve viral load test results by sample UIDs:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-js",children:"getViralLoadResults({\n  siteid: '77889900',\n  sample_uids: ['2026010401', 'IBI-2024-000001'],\n});\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Success Response (200):"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n  "data": {\n    "siteid": "22222222",\n    "results": [],\n    "sample_statuses": {\n      "634W": {\n        "sample_uid": "634W",\n        "request_found": true,\n        "request_status": "not_processed",\n        "request_mode": "api_sidainfo",\n        "sidainfo_uid": "147460",\n        "codelabo": null,\n        "date_blood_taken": "15/04/2024 11:49:00",\n        "date_blood_received": null,\n        "created_at": "2026-02-18T12:52:51.000000Z",\n        "updated_at": "2026-02-18T12:52:51.000000Z",\n        "result_status": "not_available",\n        "result_available": false,\n        "no_result_reason_code": "sample_not_processed",\n        "no_result_reason_message": "Sample request exists but has not been processed by the laboratory yet.",\n        "latest_result_meta": null,\n        "result": null\n      }\n    },\n    "no_published_results": ["634W"],\n    "no_results": ["634W"],\n    "no_results_summary": {\n      "sample_not_processed": {\n        "count": 1,\n        "sample_uids": ["634W"]\n      }\n    },\n    "not_found_sample_uids": [],\n    "total_requested": 1,\n    "total_found": 0,\n    "total_without_published_result": 1\n  },\n  "references": [{}],\n  "response": {\n    "url": "https://demo.ibipimo.org/api/v1/ask-for-vl-results",\n    "method": "POST",\n    "statusCode": 200,\n    "statusMessage": "OK",\n    "headers": {\n      "date": "Fri, 20 Feb 2026 15:14:19 GMT",\n      "server": "Apache",\n      "cache-control": "no-cache, private",\n      "access-control-allow-origin": "*",\n      "vary": "Authorization,Accept-Encoding,User-Agent",\n      "upgrade": "h2",\n      "connection": "Upgrade, Keep-Alive",\n      "keep-alive": "timeout=5, max=100",\n      "transfer-encoding": "chunked",\n      "content-type": "application/json"\n    },\n    "duration": 2760\n  }\n}\n'})}),"\n",(0,i.jsx)(n.h3,{id:"generic-post-request",children:"Generic Post Request"}),"\n",(0,i.jsx)(n.p,{children:"Post data to any endpoint:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-js",children:"post('/api/v1/your-endpoint', {\n  siteid: '77889900',\n  sample_uids: ['2026010401', 'IBI-2024-000001'],\n});\n"})}),"\n",(0,i.jsx)(n.h3,{id:"generic-post-request-1",children:"Generic Post Request"}),"\n",(0,i.jsx)(n.p,{children:"Get data from any endpoint:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-js",children:"get('/api/v1/your-endpoint');\n"})}),"\n",(0,i.jsx)(n.h3,{id:"avanced-processing",children:"Avanced processing"}),"\n",(0,i.jsx)(n.p,{children:"Handling post request response"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-js",children:"postViralLoadRequest(...);\n\nprocessViralLoadSubmission((state, processSubmission) => {\n  const submission = processSubmission(state.data);\n\n  console.log('\\n=== SUBMISSION RESULTS ===');\n  console.log(`Saved samples: ${submission.savedCount}`);\n  console.log(`Errors: ${submission.errorCount}`);\n\n  if (submission.hasErrors) {\n    console.log('\\n--- Errors ---');\n    submission.errors.forEach(error => {\n      console.log(`- ${error}`);\n    });\n  }\n\n  return {\n    ...state,\n    submissionResult: submission,\n  };\n});\n"})}),"\n",(0,i.jsx)(n.p,{children:"Handling IBIPIMO returned results:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-js",children:"getViralLoadResults(...);\n\nprocessViralLoadResults((state, processResults) => {\n  const processed = processResults(state.data);\n\n  console.log('=== VIRAL LOAD RESULTS ===');\n  console.log(`Requested result: ${processed.totalRequested}`);\n  console.log(`Total found: ${processed.totalFound}`);\n  console.log(`Total pending: ${processed.totalPending}`);\n  console.log(`Available results: ${processed.availableResults.length}`);\n  console.log(`Pending samples: ${processed.pendingSamples.length}`);\n\n  return {\n    ...state,\n    processedResults: processed,\n  };\n});\n"})}),"\n",(0,i.jsx)(n.h2,{id:"error-handling",children:"Error Handling"}),"\n",(0,i.jsx)(n.p,{children:"The adaptor handles various error responses:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"400 Bad Request"}),": Validation failed or invalid format"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"401 Unauthorized"}),": Invalid or missing access token"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"403 Forbidden"}),": Insufficient permissions"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"404 Not Found"}),": No results found for provided UIDs"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"409 Conflict"}),": Duplicate integration attempt"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"5xx Server Errors"}),": Server processing failed"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"development",children:"Development"}),"\n",(0,i.jsxs)(n.p,{children:["Clone the ",(0,i.jsx)(n.a,{href:"https://github.com/OpenFn/adaptors",children:"adaptors monorepo"}),'. Follow the\n"Getting Started" guide inside to get set up.']}),"\n",(0,i.jsx)(n.p,{children:"Go to the Adaptor project cd /packages/ibipimo"}),"\n",(0,i.jsxs)(n.p,{children:["Run tests using ",(0,i.jsx)(n.code,{children:"pnpm run test"})," or ",(0,i.jsx)(n.code,{children:"pnpm run test:watch"})]}),"\n",(0,i.jsxs)(n.p,{children:["Build the project using ",(0,i.jsx)(n.code,{children:"pnpm build"}),"."]}),"\n",(0,i.jsxs)(n.p,{children:["To build ",(0,i.jsx)(n.em,{children:"only"})," the docs run ",(0,i.jsx)(n.code,{children:"pnpm build docs"}),"."]}),"\n",(0,i.jsx)(n.h2,{id:"installation-and-testing",children:"Installation and testing"}),"\n",(0,i.jsx)(n.h3,{id:"1-install-dependencies",children:"1. Install dependencies"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"npm install\n"})}),"\n",(0,i.jsx)(n.h3,{id:"2-local-testing",children:"2. Local testing"}),"\n",(0,i.jsx)(n.h4,{id:"tmp-files",children:"tmp files"}),"\n",(0,i.jsx)(n.p,{children:"Create /tmp/state.json and /tmp/output.json files"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n  "configuration": {\n    "baseUrl": "https://demo.ibipimo.org",\n    "apiToken": "your_api_token_here"\n  },\n  "data": {}\n}\n'})}),"\n",(0,i.jsx)(n.h4,{id:"test-with-openfn-cli-if-installed",children:"Test with OpenFn CLI (if installed)"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"# Install OpenFn CLI\nnpm install -g @openfn/cli\n\n# Test individual jobs\nopenfn jobs/test-post-request.js -o tmp/output.json -s tmp/state.json\nopenfn jobs/test-get-results.js -o tmp/output.json -s tmp/state.json\nopenfn jobs/test-generic-post-request.js -o tmp/output.json -s tmp/state.json\nopenfn jobs/test-generic-get-request.js -o tmp/output.json -s tmp/state.json\nopenfn jobs/test-advanced-processing.js -o tmp/output.json -s tmp/state.json\n"})})]})}function p(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(c,{...e})}):c(e)}}}]);