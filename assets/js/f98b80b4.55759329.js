"use strict";(self.webpackChunk_openfn_docs=self.webpackChunk_openfn_docs||[]).push([[3336],{28437:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>o,default:()=>g,frontMatter:()=>i,metadata:()=>s,toc:()=>p});var a=n(58168),r=(n(96540),n(15680));const i={title:"Design your Step"},o=void 0,s={unversionedId:"build/steps/step-design-intro",id:"build/steps/step-design-intro",title:"Design your Step",description:"Before you can configure an individual Workflow Step, you'll need to design the",source:"@site/docs/build/steps/step-design-intro.md",sourceDirName:"build/steps",slug:"/build/steps/step-design-intro",permalink:"/documentation/build/steps/step-design-intro",draft:!1,editUrl:"https://github.com/openfn/docs/edit/main/docs/build/steps/step-design-intro.md",tags:[],version:"current",frontMatter:{title:"Design your Step"},sidebar:"docs",previous:{title:"Edit & Test Steps",permalink:"/documentation/build/steps/step-editor"},next:{title:"Paths",permalink:"/documentation/build/paths"}},l={},p=[{value:"1. Determine your Inputs/Outputs",id:"1-determine-your-inputsoutputs",level:2},{value:"2. Map your data elements",id:"2-map-your-data-elements",level:2},{value:"3. Define your methods (GET, POST...) and/or operations (insert, update, upsert...)",id:"3-define-your-methods-get-post-andor-operations-insert-update-upsert",level:2}],d={toc:p},u="wrapper";function g(e){let{components:t,...i}=e;return(0,r.yg)(u,(0,a.A)({},d,i,{components:t,mdxType:"MDXLayout"}),(0,r.yg)("p",null,"Before you can configure an individual Workflow Step, you'll need to design the\nentire Workflow and consider which specific tasks, activities, or business logic\nwill be executed by the individual Step. Read on for a brief overview."),(0,r.yg)("admonition",{type:"tip"},(0,r.yg)("p",{parentName:"admonition"},"Check out the ",(0,r.yg)("a",{parentName:"p",href:"/documentation/design/design-overview"},"Workflow Design")," docs for\nmore details on solution design and links to templates.")),(0,r.yg)("p",null,"In short, to design a Workflow Step, you will need to follow the below list of\nactions, and consider summarizing your design specifications in a\n",(0,r.yg)("a",{parentName:"p",href:"/documentation/design/design-workflow"},"workflow diagram"),"."),(0,r.yg)("p",null,(0,r.yg)("img",{alt:"Example Workflow",src:n(71553).A,width:"960",height:"540"})),(0,r.yg)("h2",{id:"1-determine-your-inputsoutputs"},"1. Determine your Inputs/Outputs"),(0,r.yg)("ol",null,(0,r.yg)("li",{parentName:"ol"},"What is the Input for this Workflow Step? Consider what is the initial state\nor data ",(0,r.yg)("em",{parentName:"li"},"before")," the Step begins."),(0,r.yg)("li",{parentName:"ol"},"What is the desired Output (i.e., the final state or data ",(0,r.yg)("em",{parentName:"li"},"after")," the Step is\nexecuted)? Consider what you want to send to the target app and/or pass onto\nthe next Step in the Workflow.")),(0,r.yg)("h2",{id:"2-map-your-data-elements"},"2. Map your data elements"),(0,r.yg)("p",null,(0,r.yg)("a",{parentName:"p",href:"/documentation/design/mapping-specs"},"See here"),' for detailed guidance on mapping\ndata elements or "data dictionaries" between your source and destination apps.\nTo get started:'),(0,r.yg)("ol",null,(0,r.yg)("li",{parentName:"ol"},'Export the metadata (or "form", "field list", or "data elements") of your\nsource app (input) & destination app (output).'),(0,r.yg)("li",{parentName:"ol"},"Paste the metadata into an Excel spreadsheet to create a mapping sheet:")),(0,r.yg)("p",null,(0,r.yg)("img",{alt:"Sample mapping sheet",src:n(21155).A,width:"1838",height:"448"})),(0,r.yg)("ol",{start:3},(0,r.yg)("li",{parentName:"ol"},"Map the source and destinationdata elements & define rules for data cleaning\nand transformation. Consider:")),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},"How should the data collected be translated into your destination system\u2019s\ndata model?"),(0,r.yg)("li",{parentName:"ul"},"Does your destination system have data input or validation requirements?"),(0,r.yg)("li",{parentName:"ul"},"Does the data require transformation or cleaning to satisfy the above answers?")),(0,r.yg)("h2",{id:"3-define-your-methods-get-post-andor-operations-insert-update-upsert"},"3. Define your methods (GET, POST...) and/or operations (insert, update, upsert...)"),(0,r.yg)("ol",null,(0,r.yg)("li",{parentName:"ol"},"Determine usable existing or create the unique identifiers for your data.\nUnique identifiers are used to insert and update specific records in your\ndata (e.g., uuid, form_id, patient_id, etc.)."),(0,r.yg)("li",{parentName:"ol"},"Determine the HTTP methods (e.g., GET, POST, PUT) or database operations\n(e.g. insert, update, delete) you want to perform in the target app"),(0,r.yg)("li",{parentName:"ol"},"Check the Adaptor for helper functions.",(0,r.yg)("ul",{parentName:"li"},(0,r.yg)("li",{parentName:"ul"},"Example from ",(0,r.yg)("a",{parentName:"li",href:"/adaptors/packages/postgresql-docs"},"language-postgresql"),(0,r.yg)("ul",{parentName:"li"},(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("inlineCode",{parentName:"li"},"insert(...)"),", ",(0,r.yg)("inlineCode",{parentName:"li"},"insertMany(...)")),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("inlineCode",{parentName:"li"},"update(...)"),", ",(0,r.yg)("inlineCode",{parentName:"li"},"updateMany(...)")),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("inlineCode",{parentName:"li"},"upsert(...)"),", ",(0,r.yg)("inlineCode",{parentName:"li"},"upsertMany(...)")," \xa0\u2192 update if record exists or insert if\nit doesn\u2019t; references an external Id b. Example from\n",(0,r.yg)("a",{parentName:"li",href:"/adaptors/packages/dhis2-docs"},"language-dhis2")," using Tracked Entity\nInstances (TEI)"),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("inlineCode",{parentName:"li"},"updateTEI(...)")),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("inlineCode",{parentName:"li"},"upsertTEI(...)"))))))),(0,r.yg)("p",null,"See the below example ",(0,r.yg)("inlineCode",{parentName:"p"},"Job expression"),' for a Step that will "upsert" (update or\ninsert) records in a SQL database.'),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-js"},"upsert('mainDataTable', 'AnswerId', {\n\xa0 AnswerId: dataValue('\\_id'), //external Id for upsert\n\xa0\xa0column: dataValue('firstQuestion)'),\n\xa0\xa0LastUpdate: new Date().toISOString(),\n\xa0\xa0Participant: dataValue('participant'),\n\xa0\xa0Surveyor: dataValue('surveyor'),\n\xa0\xa0...\n});\n")),(0,r.yg)("p",null,"See ",(0,r.yg)("a",{parentName:"p",href:"/documentation/jobs/job-writing-guide"},"Job Writing Guide")," for further\ninformation."))}g.isMDXComponent=!0},15680:(e,t,n)=>{n.d(t,{xA:()=>d,yg:()=>c});var a=n(96540);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var l=a.createContext({}),p=function(e){var t=a.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},d=function(e){var t=p(e.components);return a.createElement(l.Provider,{value:t},e.children)},u="mdxType",g={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},m=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,i=e.originalType,l=e.parentName,d=s(e,["components","mdxType","originalType","parentName"]),u=p(n),m=r,c=u["".concat(l,".").concat(m)]||u[m]||g[m]||i;return n?a.createElement(c,o(o({ref:t},d),{},{components:n})):a.createElement(c,o({ref:t},d))}));function c(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var i=n.length,o=new Array(i);o[0]=m;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s[u]="string"==typeof e?e:r,o[1]=s;for(var p=2;p<i;p++)o[p]=n[p];return a.createElement.apply(null,o)}return a.createElement.apply(null,n)}m.displayName="MDXCreateElement"},21155:(e,t,n)=>{n.d(t,{A:()=>a});const a=n.p+"assets/images/data-element-mapping-3d88dbb0716af7d57c3e19c6c65eb336.png"},71553:(e,t,n)=>{n.d(t,{A:()=>a});const a=n.p+"assets/images/example-workflow-state-d510389468e0f05f12ed1394629f468b.png"}}]);