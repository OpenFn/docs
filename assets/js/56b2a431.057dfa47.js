"use strict";(self.webpackChunk_openfn_docs=self.webpackChunk_openfn_docs||[]).push([[185],{3052:(e,n,a)=>{a.d(n,{A:()=>o});const o=a.p+"assets/images/commecare_forward_forms-4f9be616880611b3faccdf0eb9834137.webp"},17742:(e,n,a)=>{a.r(n),a.d(n,{assets:()=>c,contentTitle:()=>s,default:()=>h,frontMatter:()=>r,metadata:()=>o,toc:()=>l});const o=JSON.parse('{"id":"commcare","title":"CommCare Adaptor","description":"About CommCare","source":"@site/adaptors/commcare.md","sourceDirName":".","slug":"/commcare","permalink":"/adaptors/commcare","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"title":"CommCare Adaptor"},"sidebar":"adaptors","previous":{"title":"README.md","permalink":"/adaptors/packages/collections-readme"},"next":{"title":"Functions","permalink":"/adaptors/packages/commcare-docs"}}');var i=a(74848),t=a(28453);const r={title:"CommCare Adaptor"},s=void 0,c={},l=[{value:"About CommCare",id:"about-commcare",level:2},{value:"CommCare Use Cases",id:"commcare-use-cases",level:3},{value:"Integration Options",id:"integration-options",level:2},{value:"Webhook or Data Forwarding Setup (CommCare-to-OpenFn)",id:"webhook-or-data-forwarding-setup-commcare-to-openfn",level:2},{value:"Creating a Connection",id:"creating-a-connection",level:3},{value:"Data Forwarding Options",id:"data-forwarding-options",level:3},{value:"Forwarding Individual Forms",id:"forwarding-individual-forms",level:4},{value:"Forwarding Specific Case Types",id:"forwarding-specific-case-types",level:4},{value:"How to Extract or Modify CommCare Data",id:"how-to-extract-or-modify-commcare-data",level:2},{value:"Authentication",id:"authentication",level:2},{value:"Integration Design Tips",id:"integration-design-tips",level:2},{value:"CommCare Data Model",id:"commcare-data-model",level:3},{value:"Mapping CommCare Metadata to External Systems",id:"mapping-commcare-metadata-to-external-systems",level:3},{value:"Unique Identifiers",id:"unique-identifiers",level:3},{value:"Lookup Tables in CommCare",id:"lookup-tables-in-commcare",level:3},{value:"Querying Lookup Tables",id:"querying-lookup-tables",level:4},{value:"Updating Lookup Tables",id:"updating-lookup-tables",level:4},{value:"Best Practices",id:"best-practices",level:4},{value:"Troubleshooting tips",id:"troubleshooting-tips",level:4},{value:"Helpful Links",id:"helpful-links",level:2},{value:"About Forms, case and data management",id:"about-forms-case-and-data-management",level:3},{value:"CommCare API Docs",id:"commcare-api-docs",level:3},{value:"Implementation Examples",id:"implementation-examples",level:3},{value:"I&#39;ve noticed a problem with this Adaptor, or something is out of date, what can I do?",id:"ive-noticed-a-problem-with-this-adaptor-or-something-is-out-of-date-what-can-i-do",level:3}];function d(e){const n={a:"a",admonition:"admonition",blockquote:"blockquote",code:"code",em:"em",h2:"h2",h3:"h3",h4:"h4",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.h2,{id:"about-commcare",children:"About CommCare"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.a,{href:"https://www.dimagi.com/commcare/",children:"CommCare"})," is an open mobile digital platform\nfor data collection, case management, and service delivery, primarily used by\norganizations working in low-resource settings. CommCare provides a no-code\ninterface that allows non-technical users to build customized mobile\napplications for various purposes, including surveys, client tracking, decision\nsupport for frontline workers, and service delivery monitoring."]}),"\n",(0,i.jsxs)(n.p,{children:["CommCare is an open source Digital Public Good built by\n",(0,i.jsx)(n.a,{href:"https://www.dimagi.com",children:"Dimagi"}),", which also offers paid options for use of its\nCommCare cloud-hosted platform SaaS."]}),"\n",(0,i.jsx)(n.admonition,{title:"CommCare API Access",type:"info",children:(0,i.jsxs)(n.p,{children:["If using CommCare SaaS, as of October '24, only\nprojects with the Pro Plan or above include API access\n(",(0,i.jsx)(n.a,{href:"https://dimagi.atlassian.net/wiki/spaces/commcarepublic/pages/2143958022/API+Access",children:"see CommCare docs"}),")."]})}),"\n",(0,i.jsx)(n.h3,{id:"commcare-use-cases",children:"CommCare Use Cases"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Community Health Worker: Registers patients and collects data, manages cases\nover time, and provides health care and education."}),"\n",(0,i.jsx)(n.li,{children:"NGO: Collectes surveys and feedback, registers beneficiaries, and monitors\nfield activities."}),"\n",(0,i.jsx)(n.li,{children:"Government: Collects data for public services, such as health enrollment,\nschool enrollment, and census data."}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"integration-options",children:"Integration Options"}),"\n",(0,i.jsx)(n.p,{children:"CommCare supports 2 primary integration options:"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsxs)(n.strong,{children:["Webhook or\n",(0,i.jsx)(n.a,{href:"https://dimagi.atlassian.net/wiki/spaces/commcarepublic/pages/2143945549/Enabling+Data+Integration+Form+and+Case+Forwarding",children:"Data Forwarding"})]}),"\nto ",(0,i.jsx)(n.em,{children:"push"})," ",(0,i.jsx)(n.code,{children:"cases"})," and ",(0,i.jsx)(n.code,{children:"forms"})," data from CommCare to external systems. This\noption is suited for ",(0,i.jsx)(n.em,{children:"real-time"}),", event-based data integration."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.a,{href:"https://commcare-hq.readthedocs.io/api/index.html#commcare-apis",children:"REST APIs"})}),"\nthat enable external services like OpenFn to ",(0,i.jsx)(n.em,{children:"pull"})," data from CommCare, or\npush data from external apps to CommCare. This option is suited for\n",(0,i.jsx)(n.em,{children:"scheduled, bulk syncs"})," or workflows that must update data in CommCare with\nexternal information. Also ",(0,i.jsx)(n.a,{href:"https://dimagi.atlassian.net/wiki/spaces/commcarepublic/pages/2279637003/CommCare+API+Overview",children:"see here"}),"\nfor more on the API Explorer."]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["This OpenFn adaptor is designed for option #2\n",(0,i.jsx)(n.a,{href:"https://dimagi.atlassian.net/wiki/spaces/commcarepublic/pages/2279637003/CommCare+API+Overview",children:"CommCare's APIs"}),".\nRead on for how to configure the CommCare webhook (option #1) to trigger OpenFn\nworkflows based on CommCare form or case updates."]}),"\n",(0,i.jsx)(n.h2,{id:"webhook-or-data-forwarding-setup-commcare-to-openfn",children:"Webhook or Data Forwarding Setup (CommCare-to-OpenFn)"}),"\n",(0,i.jsxs)(n.p,{children:["Forward ",(0,i.jsx)(n.code,{children:"cases"})," and/or ",(0,i.jsx)(n.code,{children:"forms"})," from CommCare to OpenFn using a https webhook\nservice. To use webhoooks, you'll need to set up a CommCare connection and data\nforwarding on the forms you want to forward. See\n",(0,i.jsx)(n.a,{href:"https://dimagi.atlassian.net/wiki/spaces/commcarepublic/pages/2143945549/Enabling+Data+Integration+Form+and+Case+Forwarding",children:"CommCare docs"}),"\nor below OpenFn-tailored instructions."]}),"\n",(0,i.jsx)(n.h3,{id:"creating-a-connection",children:"Creating a Connection"}),"\n",(0,i.jsx)(n.p,{children:"To set up a connection, in CommCareHQ you'll need to:"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["Go to ",(0,i.jsx)(n.code,{children:"Project Settings"}),"."]}),"\n",(0,i.jsxs)(n.li,{children:["Click ",(0,i.jsx)(n.code,{children:"Connection Settings"}),"."]}),"\n",(0,i.jsxs)(n.li,{children:["Choose ",(0,i.jsx)(n.code,{children:"Add Connection Settings"})," at the bottom"]}),"\n",(0,i.jsxs)(n.li,{children:["Give the connection a name, and indicate email address(es) to send failure\nnotifications to\n",(0,i.jsx)(n.a,{href:"https://confluence.dimagi.com/pages/viewpage.action?pageId=12224128#EnablingDataIntegration(FormandCaseForwarding)-Errornotifications",children:"See the CommCare docs for more on this"}),"."]}),"\n",(0,i.jsxs)(n.li,{children:["Paste the URL of the OpenFn\n",(0,i.jsx)(n.a,{href:"https://docs.openfn.org/documentation/build/triggers#webhook-event-triggers",children:"webhook"}),"\nor the desintation for the data you want to forward"]}),"\n",(0,i.jsxs)(n.li,{children:["If you have ",(0,i.jsx)(n.a,{href:"https://docs.openfn.org/documentation/webhook-security",children:"webhook"}),"\nset up on OpenFn, add the authentication type, the username and password here"]}),"\n",(0,i.jsx)(n.li,{children:"You can test the connection, then save it"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"Connection",src:a(73666).A+"",width:"1107",height:"755"})}),"\n",(0,i.jsx)(n.h3,{id:"data-forwarding-options",children:"Data Forwarding Options"}),"\n",(0,i.jsx)(n.p,{children:"There are two options for forwarding data from CommCare to an external platform:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Forward ",(0,i.jsx)(n.code,{children:"forms"})," on submission (if desired, you can filter by form id)"]}),"\n",(0,i.jsxs)(n.li,{children:["Forward ",(0,i.jsx)(n.code,{children:"cases"})," on create ",(0,i.jsx)(n.em,{children:"or"})," update (if desired, you can filter by case\ntype)"]}),"\n"]}),"\n",(0,i.jsx)(n.h4,{id:"forwarding-individual-forms",children:"Forwarding Individual Forms"}),"\n",(0,i.jsx)(n.p,{children:"Forwarding individual forms is useful when you want to forward a specific form.\nHere's how you can configure CommCare to forward a form to OpenFn."}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:'Click over to "Data Forwarding".'}),"\n",(0,i.jsx)(n.li,{children:'Go to the "Forward Forms" section and click "Add a service to forward to"'}),"\n",(0,i.jsx)(n.li,{children:"Select the connection to forward the forms to set up following the steps\nabove or add a new connection"}),"\n",(0,i.jsxs)(n.li,{children:["Enter the name of the forwarder e.g. ",(0,i.jsx)(n.em,{children:"Forward Visit Forms to OpenFn"})]}),"\n",(0,i.jsx)(n.li,{children:'Select "POST" HTTP Request Method'}),"\n",(0,i.jsx)(n.li,{children:'Choose "JSON" as Payload Format'}),"\n",(0,i.jsx)(n.li,{children:"Exclude any (eg. test) users - forms submitted by them won't be forwarded"}),"\n",(0,i.jsxs)(n.li,{children:['if you want to forward all your forms, leave the "XMLNSes of forms to\ninclude" box empty or enter the XLMN of the form(s) to be forwarded and\nseparate them with commas, spaces or newlines. Follow\n',(0,i.jsx)(n.a,{href:"https://dimagi.atlassian.net/wiki/spaces/commcarepublic/pages/2143979045/Finding+a+Form+s+XMLNS",children:"this CommCare guide"}),"\nto find the XMLNS of any form."]}),"\n",(0,i.jsx)(n.li,{children:'Click "Start Forwarding" to save and activate'}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"Forms",src:a(3052).A+"",width:"1080",height:"817"})}),"\n",(0,i.jsx)(n.h4,{id:"forwarding-specific-case-types",children:"Forwarding Specific Case Types"}),"\n",(0,i.jsx)(n.p,{children:"In some cases, you may want to forward a specific case type rather than all\nforms. Here's how you can configure CommCare to forward a case type to OpenFn."}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["Go to ",(0,i.jsx)(n.code,{children:"Data Forwarding"}),"."]}),"\n",(0,i.jsxs)(n.li,{children:["Navigate to ",(0,i.jsx)(n.code,{children:"Forward Cases"})," and click ",(0,i.jsx)(n.code,{children:"Add a service to forward to"})]}),"\n",(0,i.jsx)(n.li,{children:"Select the connection to forward the cases to"}),"\n",(0,i.jsx)(n.li,{children:"Name the forwarder"}),"\n",(0,i.jsxs)(n.li,{children:["Select ",(0,i.jsx)(n.code,{children:"POST"})," HTTP Request Method"]}),"\n",(0,i.jsxs)(n.li,{children:["Choose ",(0,i.jsx)(n.code,{children:"JSON"})," as Payload Format"]}),"\n",(0,i.jsxs)(n.li,{children:["Select which case type(s) you want to forward, for example ",(0,i.jsx)(n.code,{children:"patient"})]}),"\n",(0,i.jsx)(n.li,{children:"Exclude any (eg. test) users"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"Cases",src:a(25860).A+"",width:"1153",height:"631"})}),"\n",(0,i.jsx)(n.admonition,{title:"Data Forwarding and OpenFn Workflow Design",type:"tip",children:(0,i.jsx)(n.p,{children:"We recommend a 1-to-1 relationship between workflows and data forwarding rules\non CommCare. This approached offers a clean and efficient way of updading and\nediting your workflows without impacting other forms. When doing this, note that\nevery workflow with a webhook trigger has a unique webhook URL consequently\nrequiring you to set up a separate CommCare connection for each workflow."})}),"\n",(0,i.jsx)(n.h2,{id:"how-to-extract-or-modify-commcare-data",children:"How to Extract or Modify CommCare Data"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsxs)(n.strong,{children:["See the available ",(0,i.jsx)(n.a,{href:"/adaptors/packages/commcare-docs",children:"helper functions"})]})," for a\nfull list of functions supported by this adaptor for extracting and/or modifying\nCommCare data."]}),"\n",(0,i.jsx)(n.p,{children:"To fetch data from CommCare via OpenFn, you can:"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:'Configure a new workflow with a "cron" trigger and define the frequency of\nyour workflow (e.g., daily at 8:00AM)'}),"\n",(0,i.jsx)(n.li,{children:'Add a "Get data" step linked to this CommCare adaptor'}),"\n",(0,i.jsxs)(n.li,{children:["Edit the Step and open the Inspector (",(0,i.jsx)(n.code,{children:"</>"}),") to write a basic job using this\nadaptor's ",(0,i.jsx)(n.a,{href:"/adaptors/packages/commcare-docs#get",children:"GET"})," or\n",(0,i.jsx)(n.a,{href:"/adaptors/packages/commcare-docs#bulk",children:"bulk"}),' helper functions to specify\nwhich data you want to extract or "pull" from CommCare']}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["See ",(0,i.jsx)(n.a,{href:"/documentation/build/workflows",children:"platform docs"})," for more guidance on\nbuilding workflows."]}),"\n",(0,i.jsx)(n.admonition,{title:"CommCare data export tool for spreadsheet extracts",type:"tip",children:(0,i.jsxs)(n.p,{children:["CommCare also offers a data export tool that can be used to export data from\nCommCare to a spreadsheet. This might be ideal for a one-time export of data. To\nlearn more about the data export tool, see the\n",(0,i.jsx)(n.a,{href:"https://dimagi.atlassian.net/wiki/spaces/commcarepublic/pages/2143954661/Data+Exports",children:"CommCare docs"}),"."]})}),"\n",(0,i.jsx)(n.h2,{id:"authentication",children:"Authentication"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.a,{href:"https://dimagi.atlassian.net/wiki/spaces/commcarepublic/pages/2143946031/Authentication",children:"See CommCare docs"}),"\nfor the latest on supported authentication methods."]}),"\n",(0,i.jsx)(n.p,{children:"When integrating with CommCare via OpenFn, there are 2 primary authentication\nmethods supported:"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"Basic authentication (requires username + password), or"}),"\n",(0,i.jsx)(n.li,{children:"API Key (requires username + api key created in CommCareHQ)"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsxs)(n.strong,{children:["See this adaptor's\n",(0,i.jsx)(n.a,{href:"/adaptors/packages/commcare-configuration-schema",children:"Configuration docs"})," for more\non required authentication parameters."]})}),"\n",(0,i.jsxs)(n.p,{children:["See platform docs ",(0,i.jsx)(n.a,{href:"/documentation/manage-projects/manage-credentials",children:"on managing credentials"})," for\nhow to configure a credential in OpenFn and see the below CommCare credential\nexample."]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"CommCare Cred",src:a(62441).A+"",width:"1000",height:"1626"})}),"\n",(0,i.jsxs)(n.p,{children:["If you're using the ",(0,i.jsx)(n.code,{children:"Raw JSON"})," credential type, your configuration may look like this:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n  "hostURL": "your-app-id", // e.g. https://www.commcarehq.org\n  "domain": "your-deployment-url", // e.g. demo-project\n  "appId": "your-app-id", // e.g. 1234567890\n  "username": "your-commcare-email", // e.g. user@example.com\n  "password": "your-password", // Don\'t add password if you\'re using API key auth\n  "apiKey": "your-api-key" // Don\'t add apiKey if you\'re using basic auth\n}\n'})}),"\n",(0,i.jsxs)(n.admonition,{title:"Tips for configuring your credential",type:"tip",children:[(0,i.jsx)(n.p,{children:"When filling in the CommCare credential on OpenFn, here are a few things to\nnote:"}),(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"The username is your full email address registered with CommCare"}),"\n",(0,i.jsxs)(n.li,{children:["The ",(0,i.jsx)(n.code,{children:"appId"})," is the UUID which designates your CommCare project as different\nfrom everyone elses. It can be found in the URL of your application when you\nfirst enter it from the project screen. i.e., the last part of this URL:\n",(0,i.jsx)(n.code,{children:"https://www.commcarehq.org/a/YOUR_PROJECT/apps/view/YOUR_APP_ID/"})]}),"\n",(0,i.jsxs)(n.li,{children:["The ",(0,i.jsx)(n.code,{children:"hostURL"})," is the URL of your CommCareHQ instance. For example, if your\nproject is hosted at ",(0,i.jsx)(n.code,{children:"https://commcarehq.org"}),", then your ",(0,i.jsx)(n.code,{children:"hostURL"})," is\n",(0,i.jsx)(n.code,{children:"https://commcarehq.org"}),"."]}),"\n",(0,i.jsxs)(n.li,{children:["If you have two factor authentication enabled in your CommCare account,\nconsider using API key authentication method. See more\n",(0,i.jsx)(n.a,{href:"https://dimagi.atlassian.net/wiki/spaces/commcarepublic/pages/2279637003/CommCare+API+Overview#Two-Factor-authentication",children:"details here"}),"."]}),"\n"]})]}),"\n",(0,i.jsx)(n.h2,{id:"integration-design-tips",children:"Integration Design Tips"}),"\n",(0,i.jsx)(n.h3,{id:"commcare-data-model",children:"CommCare Data Model"}),"\n",(0,i.jsxs)(n.p,{children:["When integrating with CommCare, generally there are options to read or modify\n",(0,i.jsx)(n.code,{children:"forms"}),", ",(0,i.jsx)(n.code,{children:"cases"}),", or ",(0,i.jsx)(n.code,{children:"lookup tables"}),". Most often, OpenFn users opt to integrate\n",(0,i.jsx)(n.code,{children:"cases"}),", as these records typically contain the latest information about the\nentities being managed in CommCare (e.g., patients, households, groups)."]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.a,{href:"https://dimagi.atlassian.net/wiki/spaces/commcarepublic/pages/2143954460/Metadata+Glossary#Types-of-Data-in-CommCare",children:"See CommCare docs"}),"\nfor a detailed description of the types of data."]}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"In the CommCare data model, a case is anything that we track over time, while\nform data is any information collected about a case at a specific point in\ntime through a CommCare form. Ultimately form data is the source of all case\ndata, but not all form data is case data."}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"CommCare-data-model",src:a(49535).A+"",width:"947",height:"741"})}),"\n",(0,i.jsx)(n.h3,{id:"mapping-commcare-metadata-to-external-systems",children:"Mapping CommCare Metadata to External Systems"}),"\n",(0,i.jsxs)(n.p,{children:["Use the ",(0,i.jsx)(n.a,{href:"https://dimagi.atlassian.net/wiki/spaces/commcarepublic/pages/2143956371/App+Summary",children:"CommCare App Summary"})," to view and export case or form metadata to XLS. This will help you discover what data is available to be mapped to an external system."]}),"\n",(0,i.jsx)(n.h3,{id:"unique-identifiers",children:"Unique Identifiers"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["As CommCare data is stored in forms and cases, there are two types of UIDs in\nCommCare: ",(0,i.jsx)(n.code,{children:"case_id"})," & form ",(0,i.jsx)(n.code,{children:"id"}),"."]}),"\n",(0,i.jsxs)(n.li,{children:["You can search for a particular case or form submission in CommCare by using the ",(0,i.jsx)(n.code,{children:"Find Data by ID"})," feature ",(0,i.jsx)(n.a,{href:"https://dimagi.atlassian.net/wiki/spaces/commcarepublic/pages/2143955380/Find+Data+by+ID",children:"here"}),"."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"https://dimagi.atlassian.net/wiki/spaces/commcarepublic/pages/2143946126/Generating+a+Unique+ID+for+beneficiaries",children:"See docs"})," for more on generating custom unique IDs."]}),"\n"]}),"\n",(0,i.jsx)(n.admonition,{title:"Embedding External IDs and Hidden Values in Forms",type:"tip",children:(0,i.jsxs)(n.p,{children:["If integrating with CommCare ",(0,i.jsx)(n.code,{children:"forms"}),", you may need to make sure that any unique identifiers or external IDs you want to reference in your integration are configured in your forms. You may consider using\n",(0,i.jsx)(n.a,{href:"https://dimagi.atlassian.net/wiki/spaces/commcarepublic/pages/2143954117/Hidden+Values+Tutorial+Part+1+Adding+Two+Questions+Using+a+Hidden+Value",children:"hidden values"})," to capture external IDs in form data, without affecting the end user experience."]})}),"\n",(0,i.jsx)(n.h3,{id:"lookup-tables-in-commcare",children:"Lookup Tables in CommCare"}),"\n",(0,i.jsx)(n.p,{children:"Lookup tables in CommCare store reference data that can be used across multiple forms and workflows. They are often used for predefined lists such as as health facility names, geographic locations, product catalogs, or standardized response options."}),"\n",(0,i.jsx)(n.h4,{id:"querying-lookup-tables",children:"Querying Lookup Tables"}),"\n",(0,i.jsx)(n.p,{children:"When fetching lookup table data in using CommCare APIs, there are two main approaches:"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"1. Using the Fixture API"}),"\n",(0,i.jsx)(n.a,{href:"https://commcare-hq.readthedocs.io/api/fixture.html",children:"See here"})," for the CommCare docs on this API. FYI ",(0,i.jsx)(n.code,{children:"fixture"})," is a more technical term that the CommCare docs sometimes use to refer to a ",(0,i.jsx)(n.code,{children:"lookup table"}),"."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"//sample openfn job to get a specific 'diagnosis' lookup table\nget(\"fixture/?fixture_type=diagnosis\")\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Pros:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Simple and direct API for querying a specific lookup table; response include lookup table metadata and data."}),"\n",(0,i.jsx)(n.li,{children:"Works well when items from only a couple of tables (e.g., 1-3) need to be queried."}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Cons:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Requires multiple API calls if several tables are needed, which can be inefficient at scale."}),"\n",(0,i.jsxs)(n.li,{children:["See ",(0,i.jsx)(n.code,{children:"lookup_table_item"})," API if querying data across multiple lookup tables."]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"2. Using the lookup_table_item API"}),"\n",(0,i.jsx)(n.a,{href:"https://commcare-hq.readthedocs.io/api/fixture.html#list-lookup-table-row",children:"See here"})," for the CommCare docs on this API.\nYou can use this API to query ",(0,i.jsx)(n.em,{children:"and"})," update lookup table items or rows."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:'get(\'lookup_table_item\', //to list all lookup table items across multiple tables -> bulk query\n  { limit: 100000 }); //will return 100k items at a time, which can be paged through if more are expected\n\nfn(state => {\n  //custom function to then assign & group lookup_table_items to new variables\n  const findLookupById = (id) => state.data.filter((i) => i.data_type_id === id);\n \n  //assign to facility, product, medications variables to use later in WF\n  state.facility = findLookupById("facility_table_id"); \n  state.product = findLookupById("product_table_id");\n  state.medications = findLookupById("medications_table_id");\n  return state; \n})\n'})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Pros:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Good for bulk querying lookup table rows in a single request, reducing API calls."}),"\n",(0,i.jsx)(n.li,{children:"Useful for OpenFn workflows requiring data from multiple lookup tables."}),"\n",(0,i.jsx)(n.li,{children:"Support for create & update of lookup table items."}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Cons:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Retrieves all lookup tables and filters them in-memory, which can be inefficient if only a few tables are needed."}),"\n"]}),"\n",(0,i.jsx)(n.h4,{id:"updating-lookup-tables",children:"Updating Lookup Tables"}),"\n",(0,i.jsxs)(n.p,{children:["You can bulk update rows in lookup tables using the ",(0,i.jsxs)(n.a,{href:"/adaptors/packages/commcare-docs#bulk",children:[(0,i.jsx)(n.code,{children:"bulk()"})," function"]})," in the CommCare adaptor that will utilize this ",(0,i.jsx)(n.a,{href:"https://commcare-hq.readthedocs.io/api/fixture.html#bulk-upload-lookup-tables",children:"CommCare bulk upload API"}),". ",(0,i.jsx)(n.strong,{children:"Tip:"})," Set the ",(0,i.jsx)(n.code,{children:"replace"})," option as ",(0,i.jsx)(n.code,{children:"false"})," if you want to ",(0,i.jsx)(n.em,{children:"update"})," (and not overwrite) tables."]}),"\n",(0,i.jsxs)(n.p,{children:["Or, you can edit or delete an individual lookup table row via the ",(0,i.jsx)(n.a,{href:"https://commcare-hq.readthedocs.io/api/fixture.html#edit-or-delete-lookup-table-row",children:"lookup_table_item API"}),"."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"request('PUT', `/a/${$.configuration.domain}/api/v1/lookup_table_item/${item-id}`} //to update 1 row\n\nrequest('DELETE', `/a/${$.configuration.domain}/api/v1/lookup_table_item/${item-id}`} //to delete 1 row\n"})}),"\n",(0,i.jsx)(n.h4,{id:"best-practices",children:"Best Practices"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Use the ",(0,i.jsx)(n.code,{children:"Fixture"})," API when fetching data for only a couple of (1-3) lookup tables."]}),"\n",(0,i.jsxs)(n.li,{children:["Use the ",(0,i.jsx)(n.code,{children:"lookup_table"})," API for scenarios where data from multiple lookup tables needs to be queried in bulk."]}),"\n",(0,i.jsxs)(n.li,{children:["Consider performance trade-offs when selecting which API to use, balancing API efficiency with data processing overhead. ",(0,i.jsx)(n.a,{href:"https://commcare-hq.readthedocs.io/api/index.html#data-apis",children:"See CommCare docs"})," for all available data APIs."]}),"\n"]}),"\n",(0,i.jsx)(n.h4,{id:"troubleshooting-tips",children:"Troubleshooting tips"}),"\n",(0,i.jsx)(n.p,{children:"If some tables are throwing errors when being fetched using the fixtures API, the lookup table might be corrupted. Consider exporting the table and re-importing it."}),"\n",(0,i.jsx)(n.h2,{id:"helpful-links",children:"Helpful Links"}),"\n",(0,i.jsx)(n.h3,{id:"about-forms-case-and-data-management",children:"About Forms, case and data management"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://dimagi.atlassian.net/wiki/spaces/commcarepublic/pages/2279637003/CommCare+API+Overview",children:"CommCare API Overview"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://dimagi.atlassian.net/wiki/spaces/commcarepublic/pages/2143955170/Case+Management+Overview",children:"Case management overview"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://dimagi.atlassian.net/wiki/spaces/commcarepublic/pages/2143954460/Metadata+Glossary",children:"Form and case data in CommCare"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://dimagi.atlassian.net/wiki/spaces/commcarepublic/pages/2143955074/Lookup+Tables",children:"CommCare Lookup tables"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://dimagi.atlassian.net/wiki/spaces/commcarepublic/pages/2143957320/Lookup+Table+API",children:"Lookup table APIs"})}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"commcare-api-docs",children:"CommCare API Docs"}),"\n",(0,i.jsx)(n.p,{children:"CommCare has different APIs for reading vs. modifying data. Some helpful links:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://commcare-hq.readthedocs.io/api/index.html#data-apis",children:"Data APIs"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://commcare-api-explorer.dimagi.com/",children:"API Explorer"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://dimagi.atlassian.net/wiki/spaces/commcarepublic/pages/2279637003/CommCare+API+Overview",children:"CommCare API Overview"})}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"implementation-examples",children:"Implementation Examples"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Mercy Corps Kenya (CommCare-Azure SQL DB): ",(0,i.jsx)(n.a,{href:"https://github.com/OpenFn/mercycorps-kenya",children:"https://github.com/OpenFn/mercycorps-kenya"})]}),"\n",(0,i.jsxs)(n.li,{children:["MiracleFeet (CommCare-to-Salesforce sync):\n",(0,i.jsx)(n.a,{href:"https://github.com/OpenFn/miracle-feet",children:"https://github.com/OpenFn/miracle-feet"})]}),"\n",(0,i.jsxs)(n.li,{children:["Lwala (CommCare-Salesforce 2-way sync): ",(0,i.jsx)(n.a,{href:"https://github.com/OpenFn/lwala",children:"https://github.com/OpenFn/lwala"})]}),"\n",(0,i.jsxs)(n.li,{children:["myAgro (CommCare-Salesforce): ",(0,i.jsx)(n.a,{href:"https://github.com/OpenFn/myagro-commcare-sf",children:"https://github.com/OpenFn/myagro-commcare-sf"})]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"ive-noticed-a-problem-with-this-adaptor-or-something-is-out-of-date-what-can-i-do",children:"I've noticed a problem with this Adaptor, or something is out of date, what can I do?"}),"\n",(0,i.jsxs)(n.p,{children:["Thanks for asking! We are a fully Open Source Digital Public Good, and we welcome contributions from our community. Check out our ",(0,i.jsx)(n.a,{href:"https://github.com/OpenFn/adaptors/blob/main/wiki/index.md",children:"Adaptors Wiki"})," for more information on how you can update Adaptors!"]}),"\n",(0,i.jsxs)(n.p,{children:["Or, you can always reach out to the Community through our ",(0,i.jsx)(n.a,{href:"https://community.openfn.org/",children:"Community Forum here"}),"."]})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},25860:(e,n,a)=>{a.d(n,{A:()=>o});const o=a.p+"assets/images/commcare_forward_cases-0734a2c951371d0800a60b061e300793.webp"},28453:(e,n,a)=>{a.d(n,{R:()=>r,x:()=>s});var o=a(96540);const i={},t=o.createContext(i);function r(e){const n=o.useContext(t);return o.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function s(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:r(e.components),o.createElement(t.Provider,{value:n},e.children)}},49535:(e,n,a)=>{a.d(n,{A:()=>o});const o=a.p+"assets/images/commcare-data-model-fa75d1360cdbb3bdf1f7a5f1ee38dac8.webp"},62441:(e,n,a)=>{a.d(n,{A:()=>o});const o=a.p+"assets/images/commcare_credential_edit-8bc46b14981b3a4f214fc5a5e638ae9a.webp"},73666:(e,n,a)=>{a.d(n,{A:()=>o});const o=a.p+"assets/images/commecare_connection_settings-a39191abd1bb94f6e306e44c05e58ad0.webp"}}]);