"use strict";(self.webpackChunk_openfn_docs=self.webpackChunk_openfn_docs||[]).push([[15913],{71156:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>i,default:()=>u,frontMatter:()=>r,metadata:()=>s,toc:()=>c});var o=n(58168),a=(n(96540),n(15680));const r={title:"Version Control for Staging and Production Projects",sidebar_label:"Version Control for Staging and Production Projects",slug:"/staging-prod"},i=void 0,s={unversionedId:"manage-projects/staging-prod",id:"manage-projects/staging-prod",title:"Version Control for Staging and Production Projects",description:"It's a safe and efficient practice to use separate production and staging/testing projects to build out and test your workflows before starting to use them in production. This can be made seamless using Version Control. This guide walks you through how to set up your OpenFn projects and GitHub repo and gives you an example of how to manage your Staging > Production workflow.",source:"@site/docs/manage-projects/staging-prod.md",sourceDirName:"manage-projects",slug:"/staging-prod",permalink:"/documentation/staging-prod",draft:!1,editUrl:"https://github.com/openfn/docs/edit/main/docs/manage-projects/staging-prod.md",tags:[],version:"current",frontMatter:{title:"Version Control for Staging and Production Projects",sidebar_label:"Version Control for Staging and Production Projects",slug:"/staging-prod"},sidebar:"docs",previous:{title:"OAuth Authentication",permalink:"/documentation/oauth"},next:{title:"User Profile",permalink:"/documentation/user-profile"}},l={},c=[],p={toc:c},g="wrapper";function u(e){let{components:t,...r}=e;return(0,a.yg)(g,(0,o.A)({},p,r,{components:t,mdxType:"MDXLayout"}),(0,a.yg)("p",null,"It's a safe and efficient practice to use separate production and staging/testing projects to build out and test your workflows before starting to use them in production. This can be made seamless using Version Control. This guide walks you through how to set up your OpenFn projects and GitHub repo and gives you an example of how to manage your Staging > Production workflow. "),(0,a.yg)("ol",null,(0,a.yg)("li",{parentName:"ol"},"First, create a Production and a Staging project on OpenFn")),(0,a.yg)("p",null,(0,a.yg)("img",{alt:"Prod and Staging Projects",src:n(40359).A,width:"412",height:"397"})),(0,a.yg)("ol",{start:2},(0,a.yg)("li",{parentName:"ol"},"Choose/create a GitHub repo for your project, and create a staging branch")),(0,a.yg)("p",null,(0,a.yg)("img",{alt:"Prod and Main Branches",src:n(74791).A,width:"518",height:"657"})),(0,a.yg)("ol",{start:3},(0,a.yg)("li",{parentName:"ol"},(0,a.yg)("p",{parentName:"li"},"Connect your projects to the main and staging respectively - use ",(0,a.yg)("a",{parentName:"p",href:"/documentation/link-to-GitHub"},"this guide")," to set up the connection ")),(0,a.yg)("li",{parentName:"ol"},(0,a.yg)("p",{parentName:"li"},"In each repo, create an empty .js file for your job. Make sure they have the same name and path on each repo (e.g. ",(0,a.yg)("inlineCode",{parentName:"p"},"upsert-contacts.js"),"). These will store the code for the job they'll be linked to in the next step.")),(0,a.yg)("li",{parentName:"ol"},(0,a.yg)("p",{parentName:"li"},"When you connected the branches to your projects in step 3 above, there was a ",(0,a.yg)("inlineCode",{parentName:"p"},"spec.yaml")," file automatically created on the branch after the first sync (along with two other configuration files). Open these files on GitHub, and locate your job in the file. Replace the contents of ",(0,a.yg)("inlineCode",{parentName:"p"},"body")," with: ",(0,a.yg)("inlineCode",{parentName:"p"},"path:  {path to the related js file}"),". Do this on both your ",(0,a.yg)("inlineCode",{parentName:"p"},"main")," and ",(0,a.yg)("inlineCode",{parentName:"p"},"staging")," branches."))),(0,a.yg)("p",null,(0,a.yg)("img",{alt:"Spec Main",src:n(71434).A,width:"882",height:"663"}),"\n",(0,a.yg)("img",{alt:"Spec Staging",src:n(3510).A,width:"736",height:"717"})),(0,a.yg)("ol",{start:6},(0,a.yg)("li",{parentName:"ol"},"You're now all set up!  "),(0,a.yg)("li",{parentName:"ol"},"To sync a change from your staging project to production, go to your staging project on OpenFn and make edits to your job."),(0,a.yg)("li",{parentName:"ol"},"Then go to Settings > Synch to GitHub, and click Initiate Sync to Branch"),(0,a.yg)("li",{parentName:"ol"},"Head over to GitHub. On your staging branch you'll see an update that there have been recent changes. Click ",(0,a.yg)("inlineCode",{parentName:"li"},"Compare & pull request"))),(0,a.yg)("p",null,(0,a.yg)("img",{alt:"Create Pull Request",src:n(16867).A,width:"1327",height:"137"})),(0,a.yg)("ol",{start:10},(0,a.yg)("li",{parentName:"ol"},"Create a Pull Request. This will automatically include all changes that happened to the files on the staging branch.")),(0,a.yg)("p",null,(0,a.yg)("img",{alt:"Save Pull Request",src:n(15832).A,width:"1778",height:"808"})),(0,a.yg)("ol",{start:11},(0,a.yg)("li",{parentName:"ol"},(0,a.yg)("p",{parentName:"li"},"According to your team workflow, have someone to approve and merge the Pull Request, or click ",(0,a.yg)("inlineCode",{parentName:"p"},"Merge pull request"),".")),(0,a.yg)("li",{parentName:"ol"},(0,a.yg)("p",{parentName:"li"},"Your changes will now be automatically deployed to your OpenFn prod project."))))}u.isMDXComponent=!0},15680:(e,t,n)=>{n.d(t,{xA:()=>p,yg:()=>y});var o=n(96540);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,o,a=function(e,t){if(null==e)return{};var n,o,a={},r=Object.keys(e);for(o=0;o<r.length;o++)n=r[o],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(o=0;o<r.length;o++)n=r[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var l=o.createContext({}),c=function(e){var t=o.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},p=function(e){var t=c(e.components);return o.createElement(l.Provider,{value:t},e.children)},g="mdxType",u={inlineCode:"code",wrapper:function(e){var t=e.children;return o.createElement(o.Fragment,{},t)}},d=o.forwardRef((function(e,t){var n=e.components,a=e.mdxType,r=e.originalType,l=e.parentName,p=s(e,["components","mdxType","originalType","parentName"]),g=c(n),d=a,y=g["".concat(l,".").concat(d)]||g[d]||u[d]||r;return n?o.createElement(y,i(i({ref:t},p),{},{components:n})):o.createElement(y,i({ref:t},p))}));function y(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var r=n.length,i=new Array(r);i[0]=d;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s[g]="string"==typeof e?e:a,i[1]=s;for(var c=2;c<r;c++)i[c]=n[c];return o.createElement.apply(null,i)}return o.createElement.apply(null,n)}d.displayName="MDXCreateElement"},15832:(e,t,n)=>{n.d(t,{A:()=>o});const o=n.p+"assets/images/create_pr-41ef6ff38c770ba6fce6da2a798d06f7.png"},40359:(e,t,n)=>{n.d(t,{A:()=>o});const o=n.p+"assets/images/openfn_prod_staging-98026875aa3c17cf24a2dc4bf4438486.png"},71434:(e,t,n)=>{n.d(t,{A:()=>o});const o=n.p+"assets/images/path_main-92ef45bd4b3d2fd5c5d57b60ac6b5023.png"},3510:(e,t,n)=>{n.d(t,{A:()=>o});const o=n.p+"assets/images/path_staging-73c9b7d2fef12ea52cceb2734759d1c3.png"},74791:(e,t,n)=>{n.d(t,{A:()=>o});const o=n.p+"assets/images/staging_prod_branches_gh-280d3eb3c1a5e7fd0276b0b2618df280.png"},16867:(e,t,n)=>{n.d(t,{A:()=>o});const o=n.p+"assets/images/staging_pushes-ec381e55be56f9d850a01845402ce8b1.png"}}]);