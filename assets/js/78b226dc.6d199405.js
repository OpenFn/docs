"use strict";(self.webpackChunk_openfn_docs=self.webpackChunk_openfn_docs||[]).push([[82925],{28453:(e,r,a)=>{a.d(r,{R:()=>i,x:()=>o});var s=a(96540);const t={},n=s.createContext(t);function i(e){const r=s.useContext(n);return s.useMemo((function(){return"function"==typeof e?e(r):{...r,...e}}),[r,e])}function o(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:i(e.components),s.createElement(n.Provider,{value:r},e.children)}},68058:(e,r,a)=>{a.r(r),a.d(r,{assets:()=>_,contentTitle:()=>o,default:()=>d,frontMatter:()=>i,metadata:()=>s,toc:()=>l});const s=JSON.parse('{"id":"library/jobs/auto/Upsert-Service-Referral-2-2021-06-14","title":"Upsert Service Referral 2","description":"This job was provided by an OpenFn.org user via the job library API.","source":"@site/adaptors/library/jobs/auto/Upsert-Service-Referral-2-2021-06-14.md","sourceDirName":"library/jobs/auto","slug":"/library/jobs/auto/Upsert-Service-Referral-2-2021-06-14","permalink":"/adaptors/library/jobs/auto/Upsert-Service-Referral-2-2021-06-14","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"title":"Upsert Service Referral 2","sidebar_label":"Upsert Service Referral 2","id":"Upsert-Service-Referral-2-2021-06-14","keywords":["library","job","expression","salesforce","alterState","dataValue","field","fields","upsert"]},"sidebar":"adaptors","previous":{"title":"Upsert Service Referral Followup","permalink":"/adaptors/library/jobs/auto/Upsert-Service-Referral-Followup-2021-04-30"},"next":{"title":"Upsert Service Referral","permalink":"/adaptors/library/jobs/auto/Upsert-Service-Referral-2021-04-30"}}');var t=a(74848),n=a(28453);const i={title:"Upsert Service Referral 2",sidebar_label:"Upsert Service Referral 2",id:"Upsert-Service-Referral-2-2021-06-14",keywords:["library","job","expression","salesforce","alterState","dataValue","field","fields","upsert"]},o=void 0,_={},l=[{value:"Metadata",id:"metadata",level:2},{value:"Key Functions",id:"key-functions",level:2},{value:"Expression",id:"expression",level:2}];function c(e){const r={a:"a",code:"code",h2:"h2",li:"li",p:"p",pre:"pre",ul:"ul",...(0,n.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("em",{children:"This job was provided by an OpenFn.org user via the job library API."}),"\n",(0,t.jsx)(r.h2,{id:"metadata",children:"Metadata"}),"\n",(0,t.jsxs)(r.ul,{children:["\n",(0,t.jsx)(r.li,{children:"Name: Upsert Service Referral 2"}),"\n",(0,t.jsxs)(r.li,{children:["Adaptor: ",(0,t.jsx)(r.a,{href:"https://www.github.com/openfn/language-salesforce",children:(0,t.jsx)(r.code,{children:"@openfn/language-salesforce"})})]}),"\n",(0,t.jsxs)(r.li,{children:["Adaptor Version: ",(0,t.jsx)(r.a,{href:"https://www.github.com/openfn/language-salesforce/releases/tag/v2.7.4",children:(0,t.jsx)(r.code,{children:"v2.7.4"})})]}),"\n",(0,t.jsx)(r.li,{children:"Created about 4 years ago"}),"\n",(0,t.jsx)(r.li,{children:"Updated 6 months ago"}),"\n",(0,t.jsxs)(r.li,{children:["Score: ",(0,t.jsx)("b",{children:"0"})," (an ",(0,t.jsx)(r.a,{href:"/adaptors/library/#library-scores",children:"indicator"})," of how useful this job may be)"]}),"\n"]}),"\n",(0,t.jsx)(r.h2,{id:"key-functions",children:"Key Functions"}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.code,{children:"alterState"}),", ",(0,t.jsx)(r.code,{children:"dataValue"}),", ",(0,t.jsx)(r.code,{children:"field"}),", ",(0,t.jsx)(r.code,{children:"fields"}),", ",(0,t.jsx)(r.code,{children:"upsert"})]}),"\n",(0,t.jsx)(r.h2,{id:"expression",children:"Expression"}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-js",children:"// push to production\nalterState(state => {\n  state.data.external_commcare_id = (\n    dataValue('form.hidden_properties.intervention_name')(state) +\n    dataValue('form.hidden_properties.participant_first_name')(state) +\n    dataValue('form.hidden_properties.participant_surname')(state)\n  )\n    .toString()\n    .toLowerCase()\n    .replace(/\\s/g, '')\n    .trim();\n\n  return state;\n});\n\nupsert(\n  'NewReferral__c',\n  'CommCare_Ext_ID__c',\n  fields(\n    field('Business_Unit_Site__c', state => {\n      const bu = dataValue('form.business_unit')(state);\n      return bu === 'X' ? 'GRS Zambia' : bu;\n    }),\n    field('CommCare_Ext_ID__c', dataValue('form.case.@case_id')),\n     field('HIV_Testing_Services_Service_Provider__c', state =>\n      Boolean(\n        dataValue('form.referral_services.hiv_support__care.check_services_label.hiv_support_care_option1')(state)\n      )\n    ),\n    field('TB_Screening_Service_Provider__c', state =>\n      Boolean(\n        dataValue('form.referral_services.hiv_support__care.check_services_label.hiv_support_care_option2')(state)\n      )\n    ),\n    field('VMMC_Service_Provider__c', state =>\n      Boolean(\n        dataValue('form.referral_services.hiv_support__care.check_services_label.hiv_support_care_option3')(state)\n      )\n    ),\n    field('Post_Exposure_Prophylaxis_Service_Provid__c', state =>\n      Boolean(\n        dataValue(\n          'form.referral_services.hiv_support__care.check_services_label.hiv_support_care_option4'\n        )(state)\n      )\n    ),\n    field('PrEP_Service_Provider__c', state =>\n      Boolean(\n        dataValue(\n          'form.referral_services.hiv_support__care.check_services_label.hiv_support_care_option5'\n        )(state)\n      )\n    ),\n    field('HIV_STI_PREVENTION_Other_Service_Provid__c', state =>\n      Boolean(\n        dataValue(\n          'form.referral_services.hiv_support__care.check_services_label.hiv_support_care_option6'\n        )(state)\n      )\n    ),\n    field('ART_Initiation_Service_Provider__c', state =>\n      Boolean(\n        dataValue('form.referral_services.art_support_services.art_services_group.art_services_option1')(\n          state\n        )\n      )\n    ),\n    field('SKILLZ_Plus_Club_Support_Service_Provid__c', state =>\n      Boolean(\n        dataValue('form.referral_services.art_support_services.art_services_group.art_services_option2')(\n          state\n        )\n      )\n    ),\n    \n    field(\n      'PMTCT_Service_Provider__c',\n      state =>\n        Boolean(\n          dataValue('form.referral_services.art_support_services.art_services_group.art_services_option3')(\n            state\n          )\n        )\n    ), \n    field('IPTG_Health_Facility__c', state =>\n      Boolean(\n        dataValue('form.referral_services.mental_health_services.confirmation_of_services_provided_label.mental_health_select_services_option1')(\n          state\n        )\n      )\n    ),    \n    field('IPTG_Specialized_to_SMZ__c', state =>\n      Boolean(\n        dataValue('form.referral_services.mental_health_services.confirmation_of_services_provided_label.mental_health_select_services_option2')(\n          state\n        )\n      )\n    ),   \n    \n      field('ART_Services_Other_Service_Provider__c', state =>\n        Boolean(\n          dataValue('form.referral_services.art_support_services.referred_art_support_services')(state)\n        )\n      ),\n      field(\n        'Victim_Friendly_Services_Service_Provide__c',\n        state =>\n          Boolean(\n            dataValue(\n              'form.referral_services.child_protection_support_services.copy-1-of-check_the_services_that_were_provided.child_protection_option1'\n            )(state)\n          ) ||\n          Boolean(\n            dataValue(\n              'form.referral_services.child_protection_support_services.copy-1-of-check_the_services_that_were_provided.child_protection_option2'\n            )(state)\n          ) ||\n          Boolean(\n            dataValue(\n              'form.referral_services.child_protection_support_services.copy-1-of-check_the_services_that_were_provided.child_protection_option3'\n            )(state)\n          )\n      ),\n      field('Legal_Services_Other_Service_Provider__c', state =>\n        Boolean(\n          dataValue(\n            'form.referral_services.other_legal_services.confirmation_of_services_provided_label.legal_services_option3'\n          )(state)\n        )\n      ),\n\n    field('STI_Screen_Testing_Service_Provider__c', state =>\n        Boolean(dataValue('form.referral_services.other_srhr_services.service_label.srhr_option1')(state))\n      ),\n    \n    field('Contraception_Family_Plan_Servi_Provider__c', state =>\n      Boolean(dataValue('form.referral_services.other_srhr_services.service_label.srhr_option2')(state))\n    ),\n    field('Cervical_Cancer_Screen_Servi_Provider__c', state =>\n      Boolean(dataValue('form.referral_services.other_srhr_services.service_label.srhr_option3')(state))\n    ),\n    field('HPV_vaccine_Service_Provider__c', state =>\n      Boolean(dataValue('form.referral_services.other_srhr_services.service_label.srhr_option4')(state))\n    ),\n    field('Antenatal_Care_ANC_Service_Provider__c', state =>\n      Boolean(dataValue('form.referral_services.other_srhr_services.service_label.srhr_option5')(state))\n    ),\n    field('Sexual_and_GBV_Abuse_Servi_Provider__c', state =>\n      Boolean(dataValue('form.referral_services.other_srhr_services.service_label.srhr_option6')(state))\n    ),\n    field(\n        'Psycho_Social_Support_Service_Provider__c',\n        state =>\n          Boolean(\n            dataValue(\n              'form.referral_services.other_srhr_services.service_label.srhr_option9'\n            )(state)\n          ) ||\n          Boolean(\n            dataValue(\n              'form.referral_services.other_srhr_services.service_label.srhr_option8'\n            )(state)\n          ) ||\n          Boolean(\n            dataValue(\n              'form.referral_services.other_srhr_services.service_label.srhr_option7'\n            )(state)\n          )\n      ),\n    field('Psycho_Social_Services_Other_Service_Pro__c', state =>\n      Boolean(dataValue('form.referral_services.other_srhr_services.service_label.srhr_option10')(state))\n    ),\n    field(\n        'Legal_Services_Other_Service_Provider__c',\n        state =>\n          Boolean(\n            dataValue('form.referral_services.other_legal_services.confirmation_of_services_provided_label.legal_referral_services')(state)\n          ) ||\n          Boolean(\n            dataValue('form.referral_services.other_legal_services.confirmation_of_services_provided_label.legal_services_option1')(state)\n          ) ||\n          Boolean(\n            dataValue('form.referral_services.other_legal_services.confirmation_of_services_provided_label.legal_services_option2')(state)\n          )\n      ),\n    \n  )\n);\n\n"})})]})}function d(e={}){const{wrapper:r}={...(0,n.R)(),...e.components};return r?(0,t.jsx)(r,{...e,children:(0,t.jsx)(c,{...e})}):c(e)}}}]);