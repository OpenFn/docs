"use strict";(self.webpackChunk_openfn_docs=self.webpackChunk_openfn_docs||[]).push([[12865],{28453:(e,a,t)=>{t.d(a,{R:()=>i,x:()=>_});var n=t(96540);const o={},r=n.createContext(o);function i(e){const a=n.useContext(r);return n.useMemo((function(){return"function"==typeof e?e(a):{...a,...e}}),[a,e])}function _(e){let a;return a=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:i(e.components),n.createElement(r.Provider,{value:a},e.children)}},36389:(e,a,t)=>{t.r(a),t.d(a,{assets:()=>s,contentTitle:()=>_,default:()=>d,frontMatter:()=>i,metadata:()=>n,toc:()=>c});const n=JSON.parse('{"id":"library/jobs/auto/Q4-2022-Upsert-Supervision-Household-Spot-Check-2022-08-24","title":"Q4 2022 Upsert Supervision - Household Spot Check","description":"This job was provided by an OpenFn.org user via the job library API.","source":"@site/adaptors/library/jobs/auto/Q4-2022-Upsert-Supervision-Household-Spot-Check-2022-08-24.md","sourceDirName":"library/jobs/auto","slug":"/library/jobs/auto/Q4-2022-Upsert-Supervision-Household-Spot-Check-2022-08-24","permalink":"/adaptors/library/jobs/auto/Q4-2022-Upsert-Supervision-Household-Spot-Check-2022-08-24","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"title":"Q4 2022 Upsert Supervision - Household Spot Check","sidebar_label":"Q4 2022 Upsert Supervision - Household Spot Check","id":"Q4-2022-Upsert-Supervision-Household-Spot-Check-2022-08-24","keywords":["library","job","expression","salesforce","dataValue","field","fields","relationship","upsert","upsertIf"]},"sidebar":"adaptors","previous":{"title":"Q4 2022 Upsert Supervision - Feedback","permalink":"/adaptors/library/jobs/auto/Q4-2022-Upsert-Supervision-Feedback-2022-08-19"},"next":{"title":"Q4 2022 Upsert Supervision - Accompaniment","permalink":"/adaptors/library/jobs/auto/Q4-2022-Upsert-Supervision-Accompaniment-2022-08-22"}}');var o=t(74848),r=t(28453);const i={title:"Q4 2022 Upsert Supervision - Household Spot Check",sidebar_label:"Q4 2022 Upsert Supervision - Household Spot Check",id:"Q4-2022-Upsert-Supervision-Household-Spot-Check-2022-08-24",keywords:["library","job","expression","salesforce","dataValue","field","fields","relationship","upsert","upsertIf"]},_=void 0,s={},c=[{value:"Metadata",id:"metadata",level:2},{value:"Key Functions",id:"key-functions",level:2},{value:"Expression",id:"expression",level:2}];function l(e){const a={a:"a",code:"code",h2:"h2",li:"li",p:"p",pre:"pre",ul:"ul",...(0,r.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("em",{children:"This job was provided by an OpenFn.org user via the job library API."}),"\n",(0,o.jsx)(a.h2,{id:"metadata",children:"Metadata"}),"\n",(0,o.jsxs)(a.ul,{children:["\n",(0,o.jsx)(a.li,{children:"Name: Q4 2022 Upsert Supervision - Household Spot Check"}),"\n",(0,o.jsxs)(a.li,{children:["Adaptor: ",(0,o.jsx)(a.a,{href:"https://www.github.com/openfn/language-salesforce",children:(0,o.jsx)(a.code,{children:"@openfn/language-salesforce"})})]}),"\n",(0,o.jsxs)(a.li,{children:["Adaptor Version: ",(0,o.jsx)(a.a,{href:"https://www.github.com/openfn/language-salesforce",children:(0,o.jsx)(a.code,{children:"latest"})})]}),"\n",(0,o.jsx)(a.li,{children:"Created over 3 years ago"}),"\n",(0,o.jsx)(a.li,{children:"Updated 12 months ago"}),"\n",(0,o.jsxs)(a.li,{children:["Score: ",(0,o.jsx)("b",{children:"0"})," (an ",(0,o.jsx)(a.a,{href:"/adaptors/library/#library-scores",children:"indicator"})," of how useful this job may be)"]}),"\n"]}),"\n",(0,o.jsx)(a.h2,{id:"key-functions",children:"Key Functions"}),"\n",(0,o.jsxs)(a.p,{children:[(0,o.jsx)(a.code,{children:"dataValue"}),", ",(0,o.jsx)(a.code,{children:"field"}),", ",(0,o.jsx)(a.code,{children:"fields"}),", ",(0,o.jsx)(a.code,{children:"relationship"}),", ",(0,o.jsx)(a.code,{children:"upsert"}),", ",(0,o.jsx)(a.code,{children:"upsertIf"})]}),"\n",(0,o.jsx)(a.h2,{id:"expression",children:"Expression"}),"\n",(0,o.jsx)(a.pre,{children:(0,o.jsx)(a.code,{className:"language-js",children:"//Job to integrate CommCare 'Household Spotcheck' form from the Supervision App\nfn(state => {\nstate.handleMultiSelect = function (state, multiField) {\n    return multiField\n      ? multiField\n          .replace(/ /g, ';')\n      : '';\n  };\n   return {\n    ...state\n  };\n});\n\n\nupsert(\n  'Supervision_Forms__c',\n  'CommCare_Form_ID__c',\n  fields(\n    field('CommCare_Form_ID__c', dataValue('id')),\n    relationship('RecordType', 'Name', 'Household Spotcheck Form'),\n    //  relationship('Household_Code__r', \n    //'Name',\n    //dataValue('form.prologue.hh_code')\n   // ),\n    field('Supervisor_Name__c', dataValue('form.prologue.spot_checker_sfid')),\n    field('CHW_Name__c', dataValue('form.prologue.chw_sfid')),\n      relationship(\n      'Village__r',\n      'CommCare_User_ID__c',\n      dataValue('form.prologue.village')\n    ),\n    relationship('Catchment__r', \n    'Name',\n    dataValue('form.prologue.catchment')\n    ),\n    field('Form_Date__c',dataValue('form.Date')),\n    field('CHW_Name_Identified__c',dataValue('form.chw_awareness.chw_name_reported')),\n    field('Knows_where_CHW_lives__c',dataValue('form.chw_awareness.chw_location_confirmation')),\n    field('Knows_CHW_contact_number__c',dataValue('form.chw_awareness.chw_contact_number')),\n    field('CHW_paid_for_services__c',dataValue('form.chw_awareness.service_fee')),\n    field('CHW_Visit_Frequency__c',dataValue('form.chw_awareness.chw_visit_frequency')),\n    field('Household_member_reported_fever__c',dataValue('form.iccm.fever_management')),\n    field('details_on_chw_conduct__c',dataValue('form.chw_behavior.chw_conduct_detail')),\n    field('Tablet_used__c',dataValue('form.chw_behavior.tablet_use_check')),\n    field('Other_Recommendations__c',dataValue('form.community_comments.community_recommendations_detail')),\n    field('Other_comments__c',dataValue('form.community_comments.do_you_have_any_other_comments_at_this_time')),\n    field('CHW_tested_treated_child_for_malaria__c',dataValue('form.iccm.malaria_management')),\n    field('If_so_when_Within_the__c',dataValue('form.iccm.malaria_management_timeline')),\n    field('CHW_ever_managed_your_child_for_diarrhea__c',dataValue('form.iccm.diarrhea_management')),\n    field('CHW_measured_child_s_arm_past_90_days__c',dataValue('form.iccm.muac_check')),\n    field('CHW_ever_managed_child_for__c',dataValue('form.iccm.pneumonia_management')),\n    field('rate_the_quality_of_services__c',dataValue('form.iccm.chw_service_quality')),\n    field('CHW_revisit__c',dataValue('form.referrals_and_follow-up_visits.follow_up_check_1')),\n    field('follow_up_within_3_days_of_initial_visit__c',dataValue('form.referrals_and_follow-up_visits.follow_up_check_2')),\n    field('does_CHW_revisit_child_for_follow_up__c',dataValue('form.referrals_and_follow-up_visits.follow_up_check_3')),\n    field('when_child_is_sick__c',dataValue('form.referrals_and_follow-up_visits.follow_up_check_4')),\n    field('CHW_conduct__c',dataValue('form.chw_behavior.chw_conduct_check')),\n    field('comfortable_sharing_sensitive_info__c',dataValue('form.chw_behavior.sensitive_info_check')),\n    field('Please_explain__c',dataValue('form.chw_behavior.sensitive_info_detail')),\n    field('Does_your_CHW_listen_to_your_perspective__c',dataValue('form.chw_behavior.listening_check')),\n    field('ever_experienced_a_problem_with_CHW__c', dataValue('form.chw_behavior.problem_check')),\n    field('describe_problem_experienced_with_CHW__c',dataValue('form.chw_behavior.problem_detail')),\n    field('any_recommendations_for_impr__c',dataValue('form.community_comments.community_recommendations')),\n    field('How_was_the_fever_managed__c', state => {\n      var choice = dataValue(\n        'form.iccm.fever_management_detail'\n      )(state);\n      return state.handleMultiSelect(state, choice);\n    }),\n    field('How_was_the_malaria_managed__c', state => {\n      var choice = dataValue(\n        'form.iccm.malaria_management_detail'\n      )(state);\n      return state.handleMultiSelect(state, choice);\n    }),\n    field('How_did_she_he_manage_the_diarrhea__c', state => {\n      var choice = dataValue(\n        'form.iccm.malaria_management_detail'\n      )(state);\n      return state.handleMultiSelect(state, choice);\n    }),\n     field('How_did_she_he_manage_the_pneumonia__c', state => {\n      var choice = dataValue(\n        'form.iccm.pneumonia_managemnt_detail'\n      )(state);\n      return state.handleMultiSelect(state, choice);\n    }),\n     field('COHORT_ONE_Maternal_and_Child_Health__c', state => {\n      var choice = dataValue(\n        'form.chw_service_provision.cohort_one'\n      )(state);\n      return state.handleMultiSelect(state, choice);\n    }),\n     field('COHORT_TWO_Childcare__c', state => {\n      var choice = dataValue(\n        'form.chw_service_provision.cohort_two'\n      )(state);\n      return state.handleMultiSelect(state, choice);\n    }),\n     field('COHORT_THREE_WASH_and_Nutrition__c', state => {\n      var choice = dataValue(\n        'form.chw_service_provision.cohort_three'\n      )(state);\n      return state.handleMultiSelect(state, choice);\n    }),\n     field('COHORT_FOUR_FIVE_Sexual_Reproductive__c', state => {\n      var choice = dataValue(\n        'form.chw_service_provision.cohort_four_-_five'\n      )(state);\n      return state.handleMultiSelect(state, choice);\n    }),\n  )\n); \n\nupsertIf(\n  state.data.form.prologue.hh_code !== '' &&\n  state.data.form.prologue.hh_code !== null,\n  'Supervision_Forms__c',\n  'CommCare_Form_ID__c',\n  relationship('Household_Code__r', \n    'Name',\n    dataValue('form.prologue.hh_code')\n    )\n  );\n"})})]})}function d(e={}){const{wrapper:a}={...(0,r.R)(),...e.components};return a?(0,o.jsx)(a,{...e,children:(0,o.jsx)(l,{...e})}):l(e)}}}]);