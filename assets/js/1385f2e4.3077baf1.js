"use strict";(self.webpackChunk_openfn_docs=self.webpackChunk_openfn_docs||[]).push([[69693],{28453:(e,n,s)=>{s.d(n,{R:()=>t,x:()=>a});var i=s(96540);const r={},o=i.createContext(r);function t(e){const n=i.useContext(o);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:t(e.components),i.createElement(o.Provider,{value:n},e.children)}},66832:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>c,contentTitle:()=>a,default:()=>h,frontMatter:()=>t,metadata:()=>i,toc:()=>l});const i=JSON.parse('{"id":"msgraph","title":"Microsoft Graph","description":"Overview","source":"@site/adaptors/msgraph.md","sourceDirName":".","slug":"/msgraph","permalink":"/adaptors/msgraph","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"title":"Microsoft Graph"},"sidebar":"adaptors","previous":{"title":"README.md","permalink":"/adaptors/packages/mpesa-readme"},"next":{"title":"Functions","permalink":"/adaptors/packages/msgraph-docs"}}');var r=s(74848),o=s(28453);const t={title:"Microsoft Graph"},a=void 0,c={},l=[{value:"Overview",id:"overview",level:3},{value:"Authentication and Authorization",id:"authentication-and-authorization",level:3},{value:"Permissions (Scopes)",id:"permissions-scopes",level:4},{value:"Helpful links",id:"helpful-links",level:3},{value:"I&#39;ve noticed a problem with this Adaptor, or something is out of date, what can I do?",id:"ive-noticed-a-problem-with-this-adaptor-or-something-is-out-of-date-what-can-i-do",level:3}];function d(e){const n={a:"a",admonition:"admonition",code:"code",em:"em",h3:"h3",h4:"h4",li:"li",ol:"ol",p:"p",strong:"strong",ul:"ul",...(0,o.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.h3,{id:"overview",children:"Overview"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.a,{href:"https://learn.microsoft.com/en-us/graph/overview",children:"Microsoft Graph"}),' or "MS\nGraph" is a REST API that allows you to access data and insights from data\nstored within an Organization\u2019s Microsoft 365 instance with access across\ndomains such as Microsoft Core Services, Enterprise Mobility + Security\nServices, Windows Services, and Dynamics 365 Business Central services. The MS\nGraph Rest API also allows authorized users to connect and build new\napplications that deliver value to users within and outside the organization.']}),"\n",(0,r.jsx)(n.p,{children:"This MS Graph Adaptors allows OpenFn users to seamlessly authenticate and\nintegrate with the Microsoft 265 platform to access data or perform specific\nworkflow-driven operations on behalf of a tenant or a user within the Microsoft\n365 instance. For example, the MSgraph Adaptor allows users to build OpenFn\nWorkflows to extract documents stored in SharePoint, create or update files, and\nmanage permissions. Another use case is building a workflow to connect with a\nMicrosoft user's emails, calendar, and contacts to read and manage specific\ninformation directly."}),"\n",(0,r.jsx)(n.h3,{id:"authentication-and-authorization",children:"Authentication and Authorization"}),"\n",(0,r.jsxs)(n.p,{children:["This adaptor requires OAuth authorization to connect with the MS Graph. This\nauthorization can be achieved by a user or organization admin consenting to an\nOAuth client to access resources. Users can request authorization via the\ndefault OpenFn Microsoft OAuth client or choose to Add new (generic) OAuth\nclient(s) for their account and projects. To authorize MS Graph for your OpenFn\nworkflows read our documentation on\n",(0,r.jsx)(n.a,{href:"/documentation/build/credentials#use-oauth2-credentials",children:"using OAuth credentials"}),"."]}),"\n",(0,r.jsx)(n.admonition,{type:"info",children:(0,r.jsxs)(n.p,{children:["Setting up your own generic OAuth client requires that you have an OAuth\napplication set up. Please refer to Microsoft's documentation to\n",(0,r.jsx)(n.a,{href:"https://learn.microsoft.com/en-us/entra/identity/saas-apps/openidoauth-tutorial",children:"configure an OAuth App"}),"\nvia Microsoft entra app gallery."]})}),"\n",(0,r.jsx)(n.h4,{id:"permissions-scopes",children:"Permissions (Scopes)"}),"\n",(0,r.jsxs)(n.p,{children:["Permissions and access in an OAuth instance are defined by scopes which are\nnamed differently by providers based on their functions within their platform.\nFor MS Graph, there are two types of scopes: Delegated permission and\nApplication Scopes. Delegated permissions are used by applications that sign in\na user and act on behalf of the signed-in user. These permissions require the\nuser to consent and are subject to the same data access restrictions as the user\nwithin the organization. Application scopes, on the other hand, are used by\napplications that run without a signed-in user. They require admin consent and\nprovide access to all data for an organization, typically used by background\nservices or daemons. OpenFn workflows and generic OAuth setup are compatible\nwith both the delegated and application scopes. Below is a list of commonly used\nOAuth MS Scopes for your reference. ",(0,r.jsxs)(n.strong,{children:["The scopes required will depend on your\nuse case, so please refer to the MS Graph documentation on\n",(0,r.jsx)(n.a,{href:"https://learn.microsoft.com/en-us/entra/identity-platform/scopes-oidc",children:"OAuth Scopes"}),"),\nand/or consult with your system administrator."]})]}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.em,{children:"User scopes"}),":","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"User.Read"})," (Read user profile)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"User.ReadBasic.All"})," (Read basic user profile)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"User.ReadWrite"})," (Read and write user profile)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"User.ManageIdentities.All"})," (Manage user identities)"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.em,{children:"Mail scopes"}),":","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"Mail.Read"})," (Read mail)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"Mail.ReadBasic"})," (Read basic mail)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"Mail.ReadWrite"})," (Read and write mail)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"Mail.Send"})," (Send mail)"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.em,{children:"Calendar scopes"}),":","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"Calendars.Read"})," (Read calendars)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"Calendars.ReadWrite"})," (Read and write calendars)"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.em,{children:"Contacts scopes"}),":","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"Contacts.Read"})," (Read contacts)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"Contacts.ReadWrite"})," (Read and write contacts)"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.em,{children:"Files scopes"}),":","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"Files.Read"})," (Read files)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"Files.ReadWrite"})," (Read and write files)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"Files.Read.All"})," (Read all files)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"Files.ReadWrite.All"})," (Read and write all files)"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.em,{children:"Groups scopes"}),":","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"Groups.Read.All"})," (Read all groups)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"Groups.ReadWrite.All"})," (Read and write all groups)"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.em,{children:"Directory scopes"}),":","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"Directory.Read.All"})," (Read directory)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"Directory.ReadWrite.All"})," (Read and write directory)"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.em,{children:"Application scopes"}),":","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"Application.Read.All"})," (Read applications)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"Application.ReadWrite.All"})," (Read and write applications)"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.em,{children:"Other scopes"}),":","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"offline_access"})," (Access resources even when the user is offline)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"openid"})," (Authenticate with OpenID Connect)"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"helpful-links",children:"Helpful links"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://learn.microsoft.com/en-us/graph/overview",children:"MS Graph Overview"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://learn.microsoft.com/en-us/entra/identity-platform/scopes-oidc",children:"MS Graph OAuth Scopes"})}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"ive-noticed-a-problem-with-this-adaptor-or-something-is-out-of-date-what-can-i-do",children:"I've noticed a problem with this Adaptor, or something is out of date, what can I do?"}),"\n",(0,r.jsxs)(n.p,{children:["Thanks for asking! We are a fully Open Source Digital Public Good, and we welcome contributions from our community. Check out our ",(0,r.jsx)(n.a,{href:"https://github.com/OpenFn/adaptors/blob/main/wiki/index.md",children:"Adaptors Wiki"})," for more information on how you can update Adaptors!"]}),"\n",(0,r.jsxs)(n.p,{children:["Or, you can always reach out to the Community through our ",(0,r.jsx)(n.a,{href:"https://community.openfn.org/",children:"Community Forum here"}),"."]})]})}function h(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}}}]);