"use strict";(self.webpackChunk_openfn_docs=self.webpackChunk_openfn_docs||[]).push([[23476],{15812:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>i,default:()=>g,frontMatter:()=>a,metadata:()=>s,toc:()=>p});var o=n(58168),r=(n(96540),n(15680));const a={title:"Logs & Troubleshooting",sidebar_label:"Logs & Troubleshooting",keywords:["runs","logs","log levels","status codes","exit codes","troubleshooting"]},i=void 0,s={unversionedId:"monitor-history/troubleshooting",id:"monitor-history/troubleshooting",title:"Logs & Troubleshooting",description:"This page provides troubleshooting tips for OpenFn v2 platform users.",source:"@site/docs/monitor-history/troubleshooting.md",sourceDirName:"monitor-history",slug:"/monitor-history/troubleshooting",permalink:"/documentation/monitor-history/troubleshooting",draft:!1,editUrl:"https://github.com/openfn/docs/edit/main/docs/monitor-history/troubleshooting.md",tags:[],version:"current",frontMatter:{title:"Logs & Troubleshooting",sidebar_label:"Logs & Troubleshooting",keywords:["runs","logs","log levels","status codes","exit codes","troubleshooting"]},sidebar:"docs",previous:{title:"Rerun failures",permalink:"/documentation/monitor-history/rerunning-workflow"},next:{title:"Status Codes",permalink:"/documentation/monitor-history/status-codes"}},l={},p=[{value:"Runs",id:"runs",level:2},{value:"Status codes",id:"status-codes",level:3},{value:"The time it took for the workflow to fail",id:"the-time-it-took-for-the-workflow-to-fail",level:3},{value:"Run logs",id:"run-logs",level:3},{value:"Log Levels",id:"log-levels",level:4},{value:"Mappings",id:"mappings",level:4},{value:"Error messages",id:"error-messages",level:4},{value:"Leveraging search and filtering in OpenFn",id:"leveraging-search-and-filtering-in-openfn",level:2},{value:"Sign up for email alerts",id:"sign-up-for-email-alerts",level:2},{value:"More",id:"more",level:2},{value:"Common Error Messages",id:"common-error-messages",level:3}],u={toc:p},d="wrapper";function g(e){let{components:t,...a}=e;return(0,r.yg)(d,(0,o.A)({},u,a,{components:t,mdxType:"MDXLayout"}),(0,r.yg)("p",null,"This page provides troubleshooting tips for ",(0,r.yg)("em",{parentName:"p"},"OpenFn v2 platform")," users."),(0,r.yg)("h2",{id:"runs"},"Runs"),(0,r.yg)("p",null,"One of the most helpful pages for troubleshooting on OpenFn is the\n",(0,r.yg)("a",{parentName:"p",href:"/documentation/monitor-history/activity-history"},"History")," page. This page provides a list of all of the\nruns executed for a Work Order and their status. Project administrators can\ntroubleshoot errors by clicking into the run to review the run details. Learn\nmore about runs ",(0,r.yg)("a",{parentName:"p",href:"/documentation/monitor-history/inspect-runs"},"here")," here."),(0,r.yg)("h3",{id:"status-codes"},"Status codes"),(0,r.yg)("p",null,"Every run will have a status code. The status code is a way for OpenFn to\nclassify the run status and can help you troubleshoot errors. Learn more about\nOpenFn status codes and what each one means ",(0,r.yg)("a",{parentName:"p",href:"/documentation/monitor-history/status-codes"},"here"),"."),(0,r.yg)("h3",{id:"the-time-it-took-for-the-workflow-to-fail"},"The time it took for the workflow to fail"),(0,r.yg)("p",null,"The run will also record how long it took before the workflow failed. This\ninformation helps users understand if the workflow is taking longer than it\nshould and is especially helpful with errors that involve timeouts. You can use\nthe run to determine at which operation the workflow is timing out and determine\nif the workflow performance can be optimized."),(0,r.yg)("h3",{id:"run-logs"},"Run logs"),(0,r.yg)("p",null,"As workflows are developed it is important to log details which will make\ntesting and troubleshooting much easier in the future."),(0,r.yg)("h4",{id:"log-levels"},"Log Levels"),(0,r.yg)("p",null,(0,r.yg)("img",{alt:"log-levels",src:n(75415).A,width:"1186",height:"540"})),(0,r.yg)("table",null,(0,r.yg)("thead",{parentName:"table"},(0,r.yg)("tr",{parentName:"thead"},(0,r.yg)("th",{parentName:"tr",align:null},"Level"),(0,r.yg)("th",{parentName:"tr",align:null},"Description"))),(0,r.yg)("tbody",{parentName:"table"},(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"debug")),(0,r.yg)("td",{parentName:"tr",align:null},'Shows all logs, including system-level stuff produced by the "runtime" and the output of a user-entered ',(0,r.yg)("inlineCode",{parentName:"td"},"console.debug()")," statement.")),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"info")),(0,r.yg)("td",{parentName:"tr",align:null},"The default log level, shows key information produced by the adaptors or ",(0,r.yg)("inlineCode",{parentName:"td"},"console.log()"),"/",(0,r.yg)("inlineCode",{parentName:"td"},"console.info()")," statements.")),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"warn")),(0,r.yg)("td",{parentName:"tr",align:null},"Hides most of the noise and only shows major run events (step start/end), adaptor warnings, or ",(0,r.yg)("inlineCode",{parentName:"td"},"console.warn()")," statements.")),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"error")),(0,r.yg)("td",{parentName:"tr",align:null},"Hides all but major run events, adaptor errors, and ",(0,r.yg)("inlineCode",{parentName:"td"},"console.error()")," statements.")))),(0,r.yg)("h4",{id:"mappings"},"Mappings"),(0,r.yg)("p",null,"If possible, the logs should be written so that you can see exactly what was\nmapped between the source system and the destination system. In summary, the log\ncan have a ",(0,r.yg)("strong",{parentName:"p"},'"Data received from source system"')," section and a ",(0,r.yg)("strong",{parentName:"p"},'"Data to be\nuploaded to destination system"')," section."),(0,r.yg)("p",null,"These logs can help admins verify that the source data and the data being\nuploaded to the destination system is correct. For example, seeing in the logs\nthat a unique identifier is being mapped to ",(0,r.yg)("inlineCode",{parentName:"p"},"undefined")," in the destination\nsystem can help you understand the root cause of an error. This Salesforce error\nmessage might be caused by an ",(0,r.yg)("inlineCode",{parentName:"p"},"undefined")," mapping:"),(0,r.yg)("p",null,(0,r.yg)("inlineCode",{parentName:"p"},"METHOD_NOT_ALLOWED: HTTP Method 'PATCH' not allowed. Allowed are GET,HEAD,POST at HttpApi.getError"),"."),(0,r.yg)("h4",{id:"error-messages"},"Error messages"),(0,r.yg)("p",null,"The run log should also tell us if an error has been thrown, and depending on\nthe destination system, what the error message is. Sometimes the error message\nis very specific like:"),(0,r.yg)("p",null,(0,r.yg)("inlineCode",{parentName:"p"},"NOT_FOUND: Provided external ID field does not exist or is not accessible")),(0,r.yg)("p",null,"This error from Salesforce usually indicates that ",(0,r.yg)("inlineCode",{parentName:"p"},"External ID")," has not been\nchecked in the field settings in Salesforce."),(0,r.yg)("p",null,"Other error messages are not as clear and can take some time to debug:"),(0,r.yg)("p",null,(0,r.yg)("inlineCode",{parentName:"p"},"TypeError [Error]: Cannot read property 'split' of undefined")),(0,r.yg)("p",null,(0,r.yg)("strong",{parentName:"p"},(0,r.yg)("inlineCode",{parentName:"strong"},"TypeErrors"))," usually indicate that the job received a part of the input that\nit wasn't expecting, or there is a syntax error in your job code. It means that\nthe job needs to be updated to know how to handle the input. In this case, the\njob received an old version of the Commcare form which was missing a field on\nwhich the job called the ",(0,r.yg)("inlineCode",{parentName:"p"},"split")," function. You can determine this by reviewing\nthe job for which fields the split function is being called on and checking that\nthey are all present in the message."),(0,r.yg)("p",null,"The more you test and troubleshoot with a particular system, the more familiar\nwith its error messages you become."),(0,r.yg)("admonition",{type:"tip"},(0,r.yg)("p",{parentName:"admonition"},"OpenFn has outlined several of the more common error messages specific to some\nof the systems that we have integrated in the past. Explore these systems and\ntheir error messages ",(0,r.yg)("a",{parentName:"p",href:"/adaptors#connect-anything"},"here"),".")),(0,r.yg)("h2",{id:"leveraging-search-and-filtering-in-openfn"},"Leveraging search and filtering in OpenFn"),(0,r.yg)("p",null,"Leverage the various search functionalities in OpenFn to find the right runs to\nsupport your troubleshooting. You can search on the History page across OpenFn\nIDs, Inputs, and/or Logs."),(0,r.yg)("p",null,"Check out this ",(0,r.yg)("a",{parentName:"p",href:"https://youtu.be/XIUykmLCxwQ?si=hquc8rPTJrAZkbbD"},"video")," for how\nto use Search."),(0,r.yg)("h2",{id:"sign-up-for-email-alerts"},"Sign up for email alerts"),(0,r.yg)("p",null,"You can turn on notifications to receive\n",(0,r.yg)("a",{parentName:"p",href:"/documentation/notifications"},"email alerts")," when a workflow fails and\nsubscribe to digests that summarize project activity."),(0,r.yg)("h2",{id:"more"},"More"),(0,r.yg)("blockquote",null,(0,r.yg)("p",{parentName:"blockquote"},"What happens if my survey data from ODK needs to link to existing records in\nmy Salesforce system but a respondent enters or selects an invalid\n",(0,r.yg)("inlineCode",{parentName:"p"},"external ID"),"?")),(0,r.yg)("p",null,"Great question, and don't worry, it happens all the time. Assuming you've\nalready taken all possible measures to either pre-load external IDs in your ODK\nform or use more human-proof IDs (like barcodes and fingerprints) here's the\nflow of work:"),(0,r.yg)("ol",null,(0,r.yg)("li",{parentName:"ol"},(0,r.yg)("p",{parentName:"li"},"Read the email, and inspect the reason for failure.")),(0,r.yg)("li",{parentName:"ol"},(0,r.yg)("p",{parentName:"li"},"99% of failed runs on OpenFn are due to ",(0,r.yg)("inlineCode",{parentName:"p"},"value mismatches"),". The ",(0,r.yg)("em",{parentName:"p"},"collected"),"\n",(0,r.yg)("inlineCode",{parentName:"p"},"id")," in ODK doesn't match the ",(0,r.yg)("em",{parentName:"p"},"expected")," ",(0,r.yg)("inlineCode",{parentName:"p"},"id")," in Salesforce. You must now\nchoose to either:"),(0,r.yg)("p",{parentName:"li"},"A. Edit the source ",(0,r.yg)("inlineCode",{parentName:"p"},"id")," in your ",(0,r.yg)("inlineCode",{parentName:"p"},"receipt")," & retry the attempt."),(0,r.yg)("p",{parentName:"li"},"B. Edit the related ",(0,r.yg)("inlineCode",{parentName:"p"},"id")," in your destination system & retry the attempt."),(0,r.yg)("p",{parentName:"li"},'C. Ignore the attempt\u2014this source data will never reach your destination\nsystem. (There have been reports of ODK Aggregate\'s JSON publisher sending\nduplicate values. If that happens and your run fails due to "duplicate\nvalues" on a particular unique field you can safely ignore the run in\nOpenFn.)'))),(0,r.yg)("p",null,"Editing data in your destination system can be done through that system's\ninterface. Many tools that act as ",(0,r.yg)("inlineCode",{parentName:"p"},"sources")," (like ODK) do not allow for easy\nediting and re-submission of data. You can use OpenFn to edit the source data\nbefore retrying the attempt."),(0,r.yg)("h3",{id:"common-error-messages"},"Common Error Messages"),(0,r.yg)("p",null,"The most common error messages with explanations are:"),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-sh"},"DUPLICATE_VALUE: duplicate value found: ODK_uuid__c duplicates value on record with id: a0524000005wNw0\nThe insert is blocked because you are attempting to create a new record with a\nunique field with the same value as an existing record.\n")),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-sh"},"Required value missing\n")),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-sh"},"ExternalId not found\n")),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-sh"},"{ INVALID_FIELD_FOR_INSERT_UPDATE: Unable to create/update fields: Contact__c.\nPlease check the security settings of this field and verify that it is\nread/write for your profile or permission set. }\n")),(0,r.yg)("p",null,"This last one may arise if a master-detail relationship in Salesforce is not set\nas reparentable and the user attempts to run an upsert."))}g.isMDXComponent=!0},15680:(e,t,n)=>{n.d(t,{xA:()=>u,yg:()=>m});var o=n(96540);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,o,r=function(e,t){if(null==e)return{};var n,o,r={},a=Object.keys(e);for(o=0;o<a.length;o++)n=a[o],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(o=0;o<a.length;o++)n=a[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var l=o.createContext({}),p=function(e){var t=o.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},u=function(e){var t=p(e.components);return o.createElement(l.Provider,{value:t},e.children)},d="mdxType",g={inlineCode:"code",wrapper:function(e){var t=e.children;return o.createElement(o.Fragment,{},t)}},h=o.forwardRef((function(e,t){var n=e.components,r=e.mdxType,a=e.originalType,l=e.parentName,u=s(e,["components","mdxType","originalType","parentName"]),d=p(n),h=r,m=d["".concat(l,".").concat(h)]||d[h]||g[h]||a;return n?o.createElement(m,i(i({ref:t},u),{},{components:n})):o.createElement(m,i({ref:t},u))}));function m(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var a=n.length,i=new Array(a);i[0]=h;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s[d]="string"==typeof e?e:r,i[1]=s;for(var p=2;p<a;p++)i[p]=n[p];return o.createElement.apply(null,i)}return o.createElement.apply(null,n)}h.displayName="MDXCreateElement"},75415:(e,t,n)=>{n.d(t,{A:()=>o});const o=n.p+"assets/images/log-levels-00e90bb16b0803f8b566afd261f7e985.png"}}]);