"use strict";(self.webpackChunk_openfn_docs=self.webpackChunk_openfn_docs||[]).push([[95196],{28453:(e,n,o)=>{o.d(n,{R:()=>t,x:()=>i});var s=o(96540);const a={},r=s.createContext(a);function t(e){const n=s.useContext(r);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:t(e.components),s.createElement(r.Provider,{value:n},e.children)}},29718:(e,n,o)=>{o.r(n),o.d(n,{assets:()=>l,contentTitle:()=>i,default:()=>h,frontMatter:()=>t,metadata:()=>s,toc:()=>d});const s=JSON.parse('{"id":"packages/varo-readme","title":"varo developer readme","description":"Source//github.com/OpenFn/adaptors/tree/main/packages/varo","source":"@site/adaptors/packages/varo-readme.md","sourceDirName":"packages","slug":"/packages/varo-readme","permalink":"/adaptors/packages/varo-readme","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"title":"varo developer readme","id":"varo-readme","keywords":["adaptor","readme","varo"]},"sidebar":"adaptors","previous":{"title":"Changelog","permalink":"/adaptors/packages/varo-changelog"},"next":{"title":"Functions","permalink":"/adaptors/packages/vtiger-docs"}}');var a=o(74848),r=o(28453);const t={title:"varo developer readme",id:"varo-readme",keywords:["adaptor","readme","varo"]},i="varo Adaptor developer README.md",l={},d=[{value:"Example workflow",id:"example-workflow",level:2},{value:"workflow.json",id:"workflowjson",level:3},{value:"jobGmail.js",id:"jobgmailjs",level:3},{value:"jobVaro.js",id:"jobvarojs",level:3},{value:"Example workflow",id:"example-workflow-1",level:2},{value:"workflow.js",id:"workflowjs",level:3},{value:"jobVaro.js",id:"jobvarojs-1",level:3},{value:"jobGmail.js",id:"jobgmailjs-1",level:3},{value:"Basics",id:"basics",level:2},{value:"Advanced workflow operation",id:"advanced-workflow-operation",level:2},{value:"Cache the output from a step",id:"cache-the-output-from-a-step",level:3},{value:"Running with a cached step",id:"running-with-a-cached-step",level:3},{value:"Gmail access token",id:"gmail-access-token",level:2},{value:"OpenFn collections token",id:"openfn-collections-token",level:2},{value:"Install OpenFn",id:"install-openfn",level:2},{value:"Clone the Lightning repository",id:"clone-the-lightning-repository",level:3},{value:"Build the containers",id:"build-the-containers",level:3},{value:"Install the monorepo",id:"install-the-monorepo",level:2},{value:"Prerequesites",id:"prerequesites",level:3},{value:"Clone the monorepo repository",id:"clone-the-monorepo-repository",level:3},{value:"Install the build tools",id:"install-the-build-tools",level:3},{value:"Switch to a working branch of the varo adaptor",id:"switch-to-a-working-branch-of-the-varo-adaptor",level:3},{value:"Purpose",id:"purpose",level:2},{value:"<code>records</code>: EMS-compliant daily extremes",id:"records-ems-compliant-daily-extremes",level:2},{value:"<code>zReports</code>: Out-of-spec aggregates &amp; alarm summaries",id:"zreports-out-of-spec-aggregates--alarm-summaries",level:2},{value:"Design philosophy",id:"design-philosophy",level:2}];function c(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",ul:"ul",...(0,r.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.header,{children:(0,a.jsx)(n.h1,{id:"varo-adaptor-developer-readmemd",children:"varo Adaptor developer README.md"})}),"\n",(0,a.jsxs)(n.p,{children:["Source: ",(0,a.jsx)(n.a,{href:"https://github.com/OpenFn/adaptors/tree/main/packages/varo",children:"https://github.com/OpenFn/adaptors/tree/main/packages/varo"})]}),"\n",(0,a.jsxs)(n.h1,{id:"language-varo-",children:["language-varo ",(0,a.jsx)("img",{src:"./assets/square.png",width:"30",height:"30"})]}),"\n",(0,a.jsx)(n.p,{children:"The Varo adaptor is designed to work in conjunction with the Gmail adaptor."}),"\n",(0,a.jsx)(n.p,{children:"The following workflows have been illustrated:"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"Gmail -> EMS report\nTake proprietary data formats found in Gmail messages and convert them to EMS-compliant format."}),"\n",(0,a.jsx)(n.li,{children:"CCDX data collection -> Gmail\nRetrieve data found in an OpenFn collection, convert it to a EMS report, assemble it as a Varo package and send it to a Varo inbox to be processed by Pogo LT."}),"\n"]}),"\n",(0,a.jsx)(n.h1,{id:"gmail---ems-report",children:"Gmail -> EMS report"}),"\n",(0,a.jsx)(n.p,{children:"This will demonstrate how to pull messages from a Gmail account and pass them to the Varo adaptor which will convert them into EMS format to be used for downstream consumers in the workflow."}),"\n",(0,a.jsxs)(n.p,{children:["The workflow requires some pre-configuration, namely the Gmail ",(0,a.jsx)(n.code,{children:"access_token"})," and the OpenFn ",(0,a.jsx)(n.code,{children:"collection_token"}),"."]}),"\n",(0,a.jsx)(n.h2,{id:"example-workflow",children:"Example workflow"}),"\n",(0,a.jsx)(n.p,{children:"Place these files in the openfn/adaptors/workflows/readVaroPackages folder."}),"\n",(0,a.jsx)(n.h3,{id:"workflowjson",children:"workflow.json"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-js",children:'{\n  "options": {\n    "start": "getContentsFromMessages"\n  },\n  "workflow": {\n    "steps": [\n      {\n        "id": "getContentsFromMessages",\n        "adaptors": [\n          "gmail",\n          "collections"\n        ],\n        "expression": "jobGmail.js",\n        "configuration": {\n          "access_token": "[redacted]"\n        },\n        "next": {\n          "convertToEms": "Array.isArray(state.data) && state.data.length > 0"\n        }\n      },\n      {\n        "id": "convertToEms",\n        "adaptor": "varo",\n        "expression": "jobVaro.js",\n      }\n    ],\n    "credentials": {\n      "collections_endpoint": "http://localhost:4000/collections",\n      "collections_token": "[redacted]"\n    }\n  }\n}\n'})}),"\n",(0,a.jsx)(n.h3,{id:"jobgmailjs",children:"jobGmail.js"}),"\n",(0,a.jsxs)(n.p,{children:["This job will define message parts of interest including: metadata, data and fridgeTag. Also important is a collection of previously-processed messageIds. This job will grab ids from the ",(0,a.jsx)(n.code,{children:"gmail-processed-ids"})," collection and pass them into the request. Once the request is complete, the new, processed messageIds are placed into the collection for future retrieval."]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-js",children:'const contents = [\n  { name: "metadata", file: /\\d{12}_\\d{8}T\\d{6}Z\\.json$/ },\n  { name: "data", file: /_CURRENT_DATA_.*\\.json$/ },\n  {\n    name: "data",\n    archive: /_varo_data\\.zip$/,\n    file: /_CURRENT_DATA_.*\\.json$/,\n  },\n  { name: "fridgeTag", file: /\\d{12}_\\d{12}_\\d{8}T\\d{6}Z\\.txt$/ },\n];\n\nconst collectionName = "gmail-processed-ids";\nconst itemName = "processedIds";\n\ncollections.get(collectionName, itemName);\n\ngetContentsFromMessages({\n  contents,\n  processedIds: $.data,\n});\n\nfnIf(\n  (state) => Array.isArray(state.processedIds),\n  collections.set(collectionName, itemName, $.processedIds)\n);\n'})}),"\n",(0,a.jsx)(n.h3,{id:"jobvarojs",children:"jobVaro.js"}),"\n",(0,a.jsxs)(n.p,{children:["The function ",(0,a.jsx)(n.code,{children:"convertToEms"})," expects an array of message contents. This property contains text files in EMS-like Varo format or FridgeTag format and transforms them into EMS-structured data. Tip: This format is automatically provided by the Gmail adaptor."]}),"\n",(0,a.jsx)(n.p,{children:"Expected data structure:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-js",children:"[\n  {\n    metadata: {\n      content: '',\n      filename: '',\n    },\n    data: {\n      content: '',\n      filename: '',\n    },\n  },\n]\n"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-js",children:"convertToEms($.data);\n\nfn((state) => {\n  console.log(state.data);\n  return state;\n});\n"})}),"\n",(0,a.jsx)(n.h1,{id:"ccdx-data-collection---gmail",children:"CCDX data collection -> Gmail"}),"\n",(0,a.jsx)(n.p,{children:"Following is an example demonstrating how to retrieve data found in an OpenFn collection, convert it to a EMS report, assemble it as a Varo package and send it to a Varo inbox to be processed by Pogo LT."}),"\n",(0,a.jsx)(n.h2,{id:"example-workflow-1",children:"Example workflow"}),"\n",(0,a.jsx)(n.p,{children:"Place these files in the openfn/adaptors/workflows/sendVaroPackage folder."}),"\n",(0,a.jsx)(n.h3,{id:"workflowjs",children:"workflow.js"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-js",children:'{\n  "workflow": {\n    "steps": [\n      {\n        "id": "convertRecordsToMessageContent",\n        "adaptor": "varo",\n        "expression": "jobVaro.js",\n        "next": {\n          "sendMessage": "state.data != null"\n        }\n      },\n      {\n        "id": "sendMessage",\n        "adaptor": "gmail",\n        "expression": "jobGmail.js",\n        "configuration": {\n          "access_token": "[redacted]"\n        }\n      }\n    ]\n  }\n}\n'})}),"\n",(0,a.jsx)(n.h3,{id:"jobvarojs-1",children:"jobVaro.js"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-js",children:'// Pull the data from the collection into the state.\ncollections.get("ccdx-ems", "*");\n\n// Convert the raw collection records into an EMS report.\nconvertRecordsToReport($.data);\n\n// Convert the EMS report to message contents (subject, data file).\nconvertReportToMessageContent($.data, "ems");\n'})}),"\n",(0,a.jsx)(n.h3,{id:"jobgmailjs-1",children:"jobGmail.js"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-js",children:'fn((state) => {\n  const { subject, data } = state.data;\n\n  /*\n    subject = "OpenFn | EMS";\n    data = {\n      filename: "data.json", \n      content: "{ ... EMS report converted to JSON string ... }",\n    };\n  */\n \n  // Compress the data.json file into a ZIP file.\n  const dataArchive = {\n    filename: "data.zip",\n    archive: [data],\n  };\n\n  state.data = {\n    to: "receiver@gmail.com",\n    subject,\n    attachments: [dataArchive],\n  };\n\n  return state;\n});\n\nsendMessage($.data);\n'})}),"\n",(0,a.jsx)(n.h1,{id:"running-workflow",children:"Running workflow"}),"\n",(0,a.jsx)(n.p,{children:"We can look in more detail at the Gmail -> EMS report workflow and illustrate some advanced techniques to enhance the development experience and operation."}),"\n",(0,a.jsx)(n.h2,{id:"basics",children:"Basics"}),"\n",(0,a.jsxs)(n.p,{children:["The ",(0,a.jsx)(n.code,{children:"-m"})," flag tells OpenFn to use the monorepo instead of its own adaptor cache."]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"cd openfn/adaptors/workflows/readVaroPackages\nopenfn workflow.json -m\n"})}),"\n",(0,a.jsx)(n.h2,{id:"advanced-workflow-operation",children:"Advanced workflow operation"}),"\n",(0,a.jsx)(n.p,{children:"It's beneficial to isolate the Varo adaptor during development to avoid the redundant step of repeatedly querying Gmail which also requires refreshing the access token each hour. We can use advanced functionality of the OpenFn CLI to cache the output of the Gmail step which will enable us reuse its output while we are enhancing the Varo adaptor."}),"\n",(0,a.jsx)(n.h3,{id:"cache-the-output-from-a-step",children:"Cache the output from a step"}),"\n",(0,a.jsx)(n.p,{children:"We can configure the workflow to retrieve this message content from a local file which will bypass the need to use the Gmail adaptor to retrieve this information."}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"-m"})," Use the monorepo."]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"--cache-steps"})," Direct the CLI to cache the job output."]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"--only getContentsFromMessages"})," Execute only the getContentsFromMessage step."]}),"\n"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"openfn workflow.json -m --cache-steps --only getContentsFromMessages\n"})}),"\n",(0,a.jsx)(n.h3,{id:"running-with-a-cached-step",children:"Running with a cached step"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"-m"})," Use the monorepo."]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"--only convertToEms"})," Execute only the convertToEms step."]}),"\n"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"openfn workflow.json -m --only convertToEms\n"})}),"\n",(0,a.jsx)(n.h1,{id:"token-configuration",children:"Token configuration"}),"\n",(0,a.jsx)(n.p,{children:"Some workflows required authorization to access the resources."}),"\n",(0,a.jsx)(n.h2,{id:"gmail-access-token",children:"Gmail access token"}),"\n",(0,a.jsxs)(n.p,{children:["An access token is required to access the Gmail API. This short-lived token will last 60 minutes and will have to be manually refreshed. See the documentation in the ",(0,a.jsx)(n.a,{href:"https://docs.openfn.org/adaptors/packages/gmail-readme#retrieve-an-access-token",children:"Gmail adaptor readme"})," for a guide on how to use Google Developers OAuth 2.0 Playground to retrieve and refresh the access token."]}),"\n",(0,a.jsx)(n.h2,{id:"openfn-collections-token",children:"OpenFn collections token"}),"\n",(0,a.jsx)(n.p,{children:"A workflow may track the previously processed messages by storing the processed IDs in an OpenFn collection. OpenFn requires authorization to access a given collection."}),"\n",(0,a.jsxs)(n.ol,{children:["\n",(0,a.jsxs)(n.li,{children:["Access the ",(0,a.jsx)(n.a,{href:"http://localhost:4000/settings/collections",children:"Collections"})," configuration in the administration area."]}),"\n",(0,a.jsxs)(n.li,{children:["Ensure the collection named ",(0,a.jsx)(n.code,{children:"gmail-processed-ids"})," exists."]}),"\n",(0,a.jsxs)(n.li,{children:["Create a new token in the ",(0,a.jsx)(n.a,{href:"http://localhost:4000/profile/tokens",children:"Personal Access Tokens"})," configuration."]}),"\n"]}),"\n",(0,a.jsx)(n.h1,{id:"enhancingdeveloping-the-varo-adaptor",children:"Enhancing/developing the Varo adaptor"}),"\n",(0,a.jsx)(n.p,{children:"These instructions will illustrate how to install OpenFn and the adaptor monorepo. The monorepo gives you access to in-development versions of the adaptors."}),"\n",(0,a.jsx)(n.p,{children:"Recommended folder structure:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"openfn\n\u251c\u2500\u2500 lightning\n\u2514\u2500\u2500 adaptors\n    \u251c\u2500\u2500 adaptors\n    \u2514\u2500\u2500 workflows\n"})}),"\n",(0,a.jsx)(n.h2,{id:"install-openfn",children:"Install OpenFn"}),"\n",(0,a.jsx)(n.p,{children:"Prerequisite is Docker in installed, up-to-date, and running on your computer."}),"\n",(0,a.jsx)(n.h3,{id:"clone-the-lightning-repository",children:"Clone the Lightning repository"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"cd openfn\ngit clone https://github.com/OpenFn/lightning.git\n"})}),"\n",(0,a.jsx)(n.h3,{id:"build-the-containers",children:"Build the containers"}),"\n",(0,a.jsx)(n.p,{children:"This will build three docker containers:"}),"\n",(0,a.jsxs)(n.ol,{children:["\n",(0,a.jsx)(n.li,{children:"lightning-web"}),"\n",(0,a.jsx)(n.li,{children:"postgres"}),"\n",(0,a.jsx)(n.li,{children:"ws-worker"}),"\n"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"docker compose build && docker compose run --rm web mix ecto.migrate\ndocker compose up -d\n"})}),"\n",(0,a.jsxs)(n.p,{children:["The web application will be running on ",(0,a.jsx)(n.a,{href:"http://localhost:4000",children:"localhost port 4000"}),"."]}),"\n",(0,a.jsx)(n.h2,{id:"install-the-monorepo",children:"Install the monorepo"}),"\n",(0,a.jsx)(n.p,{children:"To use the monorepo locally you'll need some prerequesite build tools installed."}),"\n",(0,a.jsx)(n.h3,{id:"prerequesites",children:"Prerequesites"}),"\n",(0,a.jsx)(n.p,{children:"asdf, nodejs, pnpm"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"git clone https://github.com/asdf-vm/asdf.git ~/.asdf\n\nasdf plugin add nodejs https://github.com/asdf-vm/asdf-nodejs.git\nasdf plugin-add pnpm\n"})}),"\n",(0,a.jsx)(n.h3,{id:"clone-the-monorepo-repository",children:"Clone the monorepo repository"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"cd openfn/adaptors\ngit clone https://github.com/OpenFn/adaptors.git\n"})}),"\n",(0,a.jsx)(n.h3,{id:"install-the-build-tools",children:"Install the build tools"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"asdf install # Install tool versions\npnpm install\npnpm build\npnpm run setup\n"})}),"\n",(0,a.jsx)(n.h3,{id:"switch-to-a-working-branch-of-the-varo-adaptor",children:"Switch to a working branch of the varo adaptor"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"cd openfn/adaptors/adaptors\ngit checkout -b varo-enhancements\n"})}),"\n",(0,a.jsxs)(n.h1,{id:"fridgetag-records-vs-zreports",children:["FridgeTag ",(0,a.jsx)(n.code,{children:"records"})," vs. ",(0,a.jsx)(n.code,{children:"zReports"})]}),"\n",(0,a.jsx)(n.h2,{id:"purpose",children:"Purpose"}),"\n",(0,a.jsxs)(n.p,{children:["The FridgeTag parser (",(0,a.jsx)(n.code,{children:"parseFridgeTagToReport"}),") reads structured device output and emits two parallel data structures: ",(0,a.jsx)(n.code,{children:"records"})," and ",(0,a.jsx)(n.code,{children:"zReports"}),". This dual design allows strict compliance with EMS standards, while also preserving valuable out-of-spec information from the original FridgeTag device logs."]}),"\n",(0,a.jsxs)(n.h2,{id:"records-ems-compliant-daily-extremes",children:[(0,a.jsx)(n.code,{children:"records"}),": EMS-compliant daily extremes"]}),"\n",(0,a.jsx)(n.p,{children:"FridgeTag source data provides daily minimum and maximum temperatures, including the exact timestamp each was observed. These data points are directly compatible with EMS requirements, which demand time-stamped records representing sensor readings."}),"\n",(0,a.jsx)(n.p,{children:"For each day in the log, the parser generates:"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"One EMS record for the minimum temperature, and"}),"\n",(0,a.jsx)(n.li,{children:"One EMS record for the maximum temperature."}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:"Each record includes:"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"ABST"}),": Absolute ISO-8601 timestamp (e.g., ",(0,a.jsx)(n.code,{children:'"2024-10-08T08:15:00.000Z"'}),")."]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"TVC"}),": Temperature value in \xb0C (e.g., ",(0,a.jsx)(n.code,{children:"18.5"}),")."]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"ALRM"}),": Optional alarm flag (e.g., ",(0,a.jsx)(n.code,{children:'"HEAT"'})," or ",(0,a.jsx)(n.code,{children:'"FRZE"'}),"), derived from alarm conditions."]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"zdescription"}),": A label for context (e.g., ",(0,a.jsx)(n.code,{children:'"2024-10-08 Min T"'}),")."]}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:"Example:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-json",children:'{\n  "ABST": "2024-10-08T08:15:00.000Z",\n  "TVC": 18.5,\n  "ALRM": null,\n  "zdescription": "2024-10-08 Min T"\n}\n'})}),"\n",(0,a.jsx)(n.p,{children:"These entries fully conform to EMS specifications and can be directly integrated into compliant pipelines or summaries."}),"\n",(0,a.jsxs)(n.h2,{id:"zreports-out-of-spec-aggregates--alarm-summaries",children:[(0,a.jsx)(n.code,{children:"zReports"}),": Out-of-spec aggregates & alarm summaries"]}),"\n",(0,a.jsx)(n.p,{children:"In addition to min/max values, FridgeTag records include:"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"A daily average temperature,"}),"\n",(0,a.jsxs)(n.li,{children:["Detailed alarm metadata: including duration of condition (",(0,a.jsx)(n.code,{children:"t Acc"}),"), first alarm timestamp (",(0,a.jsx)(n.code,{children:"TS A"}),"), and alarm count (",(0,a.jsx)(n.code,{children:"C A"}),")."]}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:"This information is not compatible with EMS formats, which don't align with aggregated statistics and rich alarm metadata. However, this data remains operationally meaningful, especially for:"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"60-day summary reports,"}),"\n",(0,a.jsx)(n.li,{children:"Country-level immunization program dashboards,"}),"\n",(0,a.jsx)(n.li,{children:"Quick on-site reviews by technicians."}),"\n"]}),"\n",(0,a.jsxs)(n.p,{children:["To retain this data without violating EMS constraints, the parser generates a ",(0,a.jsx)(n.code,{children:"zReports"})," array. Each entry summarizes one day:"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-json",children:'{\n  "date": "2024-10-08T00:00:00.000Z",\n  "duration": "1D",\n  "alarms": [\n    {\n      "condition": "HEAT",\n      "conditionMinutes": 840,\n      "alarmTime": "2024-10-08T00:00:00.000Z"\n    }\n  ],\n  "aggregates": [\n    {\n      "id": "TVC",\n      "min": 18.5,\n      "max": 21.2,\n      "average": 19.2\n    }\n  ]\n}\n'})}),"\n",(0,a.jsxs)(n.p,{children:["This structure is deliberately out-of-spec (hence the ",(0,a.jsx)(n.code,{children:"z"})," prefix) and is ignored by EMS consumers. It is retained only for dashboards, exports, and enriched user-facing analytics."]}),"\n",(0,a.jsx)(n.h2,{id:"design-philosophy",children:"Design philosophy"}),"\n",(0,a.jsx)(n.p,{children:"This split structure reflects a disciplined compromise between compliance and pragmatism:"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"records"}),": strictly EMS-compliant atomic data points."]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"zReports"}),": high-value extras that don't align with EMS, but still provide value."]}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:"This ensures that:"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"Nothing is lost from the original FridgeTag data."}),"\n",(0,a.jsx)(n.li,{children:"Downstream EMS systems remain unaffected."}),"\n",(0,a.jsx)(n.li,{children:"Local insights and user-friendly summaries remain rich and actionable."}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(c,{...e})}):c(e)}}}]);