"use strict";(self.webpackChunk_openfn_docs=self.webpackChunk_openfn_docs||[]).push([[19782],{28453:(e,s,n)=>{n.d(s,{R:()=>l,x:()=>i});var t=n(96540);const c={},r=t.createContext(c);function l(e){const s=t.useContext(r);return t.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function i(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(c):e.components||c:l(e.components),t.createElement(r.Provider,{value:s},e.children)}},40656:(e,s,n)=>{n.r(s),n.d(s,{assets:()=>o,contentTitle:()=>i,default:()=>h,frontMatter:()=>l,metadata:()=>t,toc:()=>a});const t=JSON.parse('{"id":"packages/collections-docs","title":"collections@0.7.9","description":"This adaptor exports the following namespaced functions:","source":"@site/adaptors/packages/collections-docs.md","sourceDirName":"packages","slug":"/packages/collections-docs","permalink":"/adaptors/packages/collections-docs","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"title":"collections@0.7.9","id":"collections-docs","keywords":["adaptor","collections"]},"sidebar":"adaptors","previous":{"title":"Overview","permalink":"/adaptors/collections"},"next":{"title":"Configuration","permalink":"/adaptors/packages/collections-configuration-schema"}}');var c=n(74848),r=n(28453);const l={title:"collections@0.7.9",id:"collections-docs",keywords:["adaptor","collections"]},i=void 0,o={},a=[{value:"collections",id:"collections",level:2},{value:"collections.each",id:"collections_each",level:3},{value:"collections.get",id:"collections_get",level:3},{value:"collections.remove",id:"collections_remove",level:3},{value:"collections.set",id:"collections_set",level:3},{value:"Interfaces",id:"interfaces",level:2},{value:"QueryOptions",id:"queryoptions",level:3}];function d(e){const s={a:"a",code:"code",h2:"h2",h3:"h3",hr:"hr",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,r.R)(),...e.components};return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(s.p,{children:"This adaptor exports the following namespaced functions:"}),"\n",(0,c.jsxs)("dl",{children:[(0,c.jsx)("dt",{children:(0,c.jsx)("a",{href:"#collections_each",children:"collections.each(name, query, callback)"})}),(0,c.jsx)("dt",{children:(0,c.jsx)("a",{href:"#collections_get",children:"collections.get(name, query)"})}),(0,c.jsx)("dt",{children:(0,c.jsx)("a",{href:"#collections_remove",children:"collections.remove(name, query)"})}),(0,c.jsx)("dt",{children:(0,c.jsx)("a",{href:"#collections_set",children:"collections.set(name, keygen, values)"})})]}),"\n",(0,c.jsx)(s.h2,{id:"collections",children:"collections"}),"\n",(0,c.jsx)(s.p,{children:"These functions belong to the collections namespace."}),"\n",(0,c.jsx)(s.h3,{id:"collections_each",children:"collections.each"}),"\n",(0,c.jsx)("p",{children:(0,c.jsx)("code",{children:"each(name, query, callback)"})}),"\n",(0,c.jsxs)(s.p,{children:["Iterate over all values in a collection which match the provided query.\neach() maintains a low memory footprint by streaming items individually.\nYou can pass a string key-pattern as a query, or pass a query object.\nThe callback function will be invoked for each value with three parameters:\n",(0,c.jsx)(s.code,{children:"state"}),", ",(0,c.jsx)(s.code,{children:"value"})," and ",(0,c.jsx)(s.code,{children:"key"}),".\nChanging the page size does not affect the callback function (only one item is\never passed at a time)."]}),"\n",(0,c.jsxs)(s.table,{children:[(0,c.jsx)(s.thead,{children:(0,c.jsxs)(s.tr,{children:[(0,c.jsx)(s.th,{children:"Param"}),(0,c.jsx)(s.th,{children:"Type"}),(0,c.jsx)(s.th,{children:"Description"})]})}),(0,c.jsxs)(s.tbody,{children:[(0,c.jsxs)(s.tr,{children:[(0,c.jsx)(s.td,{children:"name"}),(0,c.jsx)(s.td,{children:(0,c.jsx)("code",{children:"string"})}),(0,c.jsx)(s.td,{children:"The name of the collection to remove from"})]}),(0,c.jsxs)(s.tr,{children:[(0,c.jsx)(s.td,{children:"query"}),(0,c.jsxs)(s.td,{children:[(0,c.jsx)("code",{children:"string"})," | ",(0,c.jsx)(s.a,{href:"#queryoptions",children:(0,c.jsx)("code",{children:"QueryOptions"})})]}),(0,c.jsx)(s.td,{children:"A string key or key pattern (with wildcards '*') to remove, or a query object"})]}),(0,c.jsxs)(s.tr,{children:[(0,c.jsx)(s.td,{children:"callback"}),(0,c.jsx)(s.td,{children:(0,c.jsx)("code",{children:"function"})}),(0,c.jsxs)(s.td,{children:["A callback invoked for each item ",(0,c.jsx)(s.code,{children:"(state,  value, key) => void"})]})]})]})]}),"\n",(0,c.jsx)(s.p,{children:"This operation writes the following keys to state:"}),"\n",(0,c.jsxs)(s.table,{children:[(0,c.jsx)(s.thead,{children:(0,c.jsxs)(s.tr,{children:[(0,c.jsx)(s.th,{children:"State Key"}),(0,c.jsx)(s.th,{children:"Description"})]})}),(0,c.jsxs)(s.tbody,{children:[(0,c.jsxs)(s.tr,{children:[(0,c.jsx)(s.td,{children:"data.cursor"}),(0,c.jsx)(s.td,{children:"if values are still left on the server, a cursor string will be written to state.data"})]}),(0,c.jsxs)(s.tr,{children:[(0,c.jsxs)(s.td,{children:[(0,c.jsx)(s.strong,{children:"Example:"})," Iterate over a range of values with wildcards"]}),(0,c.jsx)(s.td,{})]})]})]}),"\n",(0,c.jsx)(s.pre,{children:(0,c.jsx)(s.code,{className:"language-js",children:"collections.each('my-collection', 'record-2024*-appointment-*', (state, value, key) => {\n  state.cumulativeCost += value.cost;\n})\n"})}),"\n",(0,c.jsxs)(s.p,{children:[(0,c.jsx)(s.strong,{children:"Example:"})," Iterate over a range of values with date filters"]}),"\n",(0,c.jsx)(s.pre,{children:(0,c.jsx)(s.code,{className:"language-js",children:"collections.each('my-collection', { createdBefore: new Date().toString() }, (state, value, key) => {\n  state.cumulativeCost += value.cost;\n})\n"})}),"\n",(0,c.jsx)(s.hr,{}),"\n",(0,c.jsx)(s.h3,{id:"collections_get",children:"collections.get"}),"\n",(0,c.jsx)("p",{children:(0,c.jsx)("code",{children:"get(name, query)"})}),"\n",(0,c.jsx)(s.p,{children:"Fetch one or more values from a collection.\nFor large datasets, we recommend using each(), which streams data.\nYou can pass a specific key as a string to only fetch one item, or pass a query\nwith a key-pattern or a date filter.\nIf not all matching values are returned, the cursor position is written to state.data"}),"\n",(0,c.jsxs)(s.table,{children:[(0,c.jsx)(s.thead,{children:(0,c.jsxs)(s.tr,{children:[(0,c.jsx)(s.th,{children:"Param"}),(0,c.jsx)(s.th,{children:"Type"}),(0,c.jsx)(s.th,{children:"Description"})]})}),(0,c.jsxs)(s.tbody,{children:[(0,c.jsxs)(s.tr,{children:[(0,c.jsx)(s.td,{children:"name"}),(0,c.jsx)(s.td,{children:(0,c.jsx)("code",{children:"string"})}),(0,c.jsx)(s.td,{children:"The name of the collection to fetch from"})]}),(0,c.jsxs)(s.tr,{children:[(0,c.jsx)(s.td,{children:"query"}),(0,c.jsxs)(s.td,{children:[(0,c.jsx)("code",{children:"string"})," | ",(0,c.jsx)(s.a,{href:"#queryoptions",children:(0,c.jsx)("code",{children:"QueryOptions"})})]}),(0,c.jsx)(s.td,{children:"A string key or key pattern (with wildcards '*') to fetch, or a query object"})]})]})]}),"\n",(0,c.jsx)(s.p,{children:"This operation writes the following keys to state:"}),"\n",(0,c.jsxs)(s.table,{children:[(0,c.jsx)(s.thead,{children:(0,c.jsxs)(s.tr,{children:[(0,c.jsx)(s.th,{children:"State Key"}),(0,c.jsx)(s.th,{children:"Description"})]})}),(0,c.jsxs)(s.tbody,{children:[(0,c.jsxs)(s.tr,{children:[(0,c.jsx)(s.td,{children:"data"}),(0,c.jsx)(s.td,{children:"the downloaded values as an array unless a specific key was specified, in which case state.data is the value"})]}),(0,c.jsxs)(s.tr,{children:[(0,c.jsxs)(s.td,{children:[(0,c.jsx)(s.strong,{children:"Example:"})," Get a specific value from a collection"]}),(0,c.jsx)(s.td,{})]})]})]}),"\n",(0,c.jsx)(s.pre,{children:(0,c.jsx)(s.code,{className:"language-js",children:"collections.get('my-collection', '556e0a62')\n"})}),"\n",(0,c.jsxs)(s.p,{children:[(0,c.jsx)(s.strong,{children:"Example:"})," Get a range of values from a collection with a key pattern"]}),"\n",(0,c.jsx)(s.pre,{children:(0,c.jsx)(s.code,{className:"language-js",children:"collections.get('my-collection', '2024*')\n"})}),"\n",(0,c.jsxs)(s.p,{children:[(0,c.jsx)(s.strong,{children:"Example:"})," Get all values created since the end of January 2024"]}),"\n",(0,c.jsx)(s.pre,{children:(0,c.jsx)(s.code,{className:"language-js",children:"collections.get('my-collection', { createdAfter: '202401'})\n"})}),"\n",(0,c.jsx)(s.hr,{}),"\n",(0,c.jsx)(s.h3,{id:"collections_remove",children:"collections.remove"}),"\n",(0,c.jsx)("p",{children:(0,c.jsx)("code",{children:"remove(name, query)"})}),"\n",(0,c.jsx)(s.p,{children:"Remove one or more values from a collection.\nYou can pass a specific key as a string to only fetch one item, or pass a query\nwith a key-pattern or a date filter."}),"\n",(0,c.jsxs)(s.table,{children:[(0,c.jsx)(s.thead,{children:(0,c.jsxs)(s.tr,{children:[(0,c.jsx)(s.th,{children:"Param"}),(0,c.jsx)(s.th,{children:"Type"}),(0,c.jsx)(s.th,{children:"Description"})]})}),(0,c.jsxs)(s.tbody,{children:[(0,c.jsxs)(s.tr,{children:[(0,c.jsx)(s.td,{children:"name"}),(0,c.jsx)(s.td,{children:(0,c.jsx)("code",{children:"string"})}),(0,c.jsx)(s.td,{children:"The name of the collection to remove from"})]}),(0,c.jsxs)(s.tr,{children:[(0,c.jsx)(s.td,{children:"query"}),(0,c.jsxs)(s.td,{children:[(0,c.jsx)("code",{children:"string"})," | ",(0,c.jsx)(s.a,{href:"#queryoptions",children:(0,c.jsx)("code",{children:"QueryOptions"})})]}),(0,c.jsx)(s.td,{children:"A string key or key pattern (with wildcards '*') to remove, or a query object"})]})]})]}),"\n",(0,c.jsxs)(s.p,{children:[(0,c.jsx)(s.strong,{children:"Example:"})," Remove a specific value from a collection"]}),"\n",(0,c.jsx)(s.pre,{children:(0,c.jsx)(s.code,{className:"language-js",children:"collections.remove('my-collection', '556e0a62')\n"})}),"\n",(0,c.jsxs)(s.p,{children:[(0,c.jsx)(s.strong,{children:"Example:"})," Remove a range of values from a collection with a key pattern"]}),"\n",(0,c.jsx)(s.pre,{children:(0,c.jsx)(s.code,{className:"language-js",children:"collections.remove('my-collection', '2024*')\n"})}),"\n",(0,c.jsxs)(s.p,{children:[(0,c.jsx)(s.strong,{children:"Example:"})," Remove all values created since the end of January 2024"]}),"\n",(0,c.jsx)(s.pre,{children:(0,c.jsx)(s.code,{className:"language-js",children:"collections.remove('my-collection', { createdAfter: '202401'})\n"})}),"\n",(0,c.jsx)(s.hr,{}),"\n",(0,c.jsx)(s.h3,{id:"collections_set",children:"collections.set"}),"\n",(0,c.jsx)("p",{children:(0,c.jsx)("code",{children:"set(name, keygen, values)"})}),"\n",(0,c.jsx)(s.p,{children:"Adds one or more values to a collection. If a key already exists, its value will\nbe replaced by the new value.\nYou can pass a string key and a single value, or a key generator function and an array of values.\nThe function will be called for each value, passing each value as the first argument, and should return\na string key."}),"\n",(0,c.jsxs)(s.table,{children:[(0,c.jsx)(s.thead,{children:(0,c.jsxs)(s.tr,{children:[(0,c.jsx)(s.th,{children:"Param"}),(0,c.jsx)(s.th,{children:"Type"}),(0,c.jsx)(s.th,{children:"Description"})]})}),(0,c.jsxs)(s.tbody,{children:[(0,c.jsxs)(s.tr,{children:[(0,c.jsx)(s.td,{children:"name"}),(0,c.jsx)(s.td,{children:(0,c.jsx)("code",{children:"string"})}),(0,c.jsx)(s.td,{children:"The name of the collection to fetch from"})]}),(0,c.jsxs)(s.tr,{children:[(0,c.jsx)(s.td,{children:"keygen"}),(0,c.jsx)(s.td,{}),(0,c.jsx)(s.td,{children:"a function which generates a key for each value: (value, index) => key. Pass a string to set a static key for a single item."})]}),(0,c.jsxs)(s.tr,{children:[(0,c.jsx)(s.td,{children:"values"}),(0,c.jsx)(s.td,{}),(0,c.jsx)(s.td,{children:"an array of values to set, or a single value."})]})]})]}),"\n",(0,c.jsxs)(s.p,{children:[(0,c.jsx)(s.strong,{children:"Example:"})," Set a number of values using each value's id property as a key"]}),"\n",(0,c.jsx)(s.pre,{children:(0,c.jsx)(s.code,{className:"language-js",children:"collections.set('my-collection', (item) => item.id, $.data)\n"})}),"\n",(0,c.jsxs)(s.p,{children:[(0,c.jsx)(s.strong,{children:"Example:"})," Set a number of values, generating an id from a string template"]}),"\n",(0,c.jsx)(s.pre,{children:(0,c.jsx)(s.code,{className:"language-js",children:"collections.set('my-collection', (item) => `${item.category}-${Date.now()}`, $.data)\n"})}),"\n",(0,c.jsxs)(s.p,{children:[(0,c.jsx)(s.strong,{children:"Example:"})," Set a single value with a static key"]}),"\n",(0,c.jsx)(s.pre,{children:(0,c.jsx)(s.code,{className:"language-js",children:"collections.set('my-collection', 'city-codes', { NY: 'New York', LDN: 'London' })\n"})}),"\n",(0,c.jsx)(s.hr,{}),"\n",(0,c.jsx)(s.h2,{id:"interfaces",children:"Interfaces"}),"\n",(0,c.jsx)(s.h3,{id:"queryoptions",children:"QueryOptions"}),"\n",(0,c.jsxs)(s.p,{children:["Query options. All dates should be parseable as ISO 8601 strings, see ",(0,c.jsx)(s.a,{href:"https://simple.wikipedia.org/wiki/ISO_8601",children:"https://simple.wikipedia.org/wiki/ISO_8601"})]}),"\n",(0,c.jsx)(s.p,{children:(0,c.jsx)(s.strong,{children:"Properties"})}),"\n",(0,c.jsxs)(s.table,{children:[(0,c.jsx)(s.thead,{children:(0,c.jsxs)(s.tr,{children:[(0,c.jsx)(s.th,{children:"Name"}),(0,c.jsx)(s.th,{children:"Type"}),(0,c.jsx)(s.th,{children:"Description"})]})}),(0,c.jsxs)(s.tbody,{children:[(0,c.jsxs)(s.tr,{children:[(0,c.jsx)(s.td,{children:"key"}),(0,c.jsx)(s.td,{children:(0,c.jsx)("code",{children:"string"})}),(0,c.jsxs)(s.td,{children:["key or key pattern to match against. Patterns support wildcards,  eg ",(0,c.jsx)(s.code,{children:"2024-01*"})]})]}),(0,c.jsxs)(s.tr,{children:[(0,c.jsx)(s.td,{children:"createdBefore"}),(0,c.jsx)(s.td,{children:(0,c.jsx)("code",{children:"string"})}),(0,c.jsx)(s.td,{children:"matches values that were created before the start of the provided date"})]}),(0,c.jsxs)(s.tr,{children:[(0,c.jsx)(s.td,{children:"createdAfter"}),(0,c.jsx)(s.td,{children:(0,c.jsx)("code",{children:"string"})}),(0,c.jsx)(s.td,{children:"matches values that were created after the end of the provided date"})]}),(0,c.jsxs)(s.tr,{children:[(0,c.jsx)(s.td,{children:"limit"}),(0,c.jsx)(s.td,{children:(0,c.jsx)("code",{children:"number"})}),(0,c.jsx)(s.td,{children:"limit the maximum amount of results. If Infinity or unset, all items will be fetched. Default: Infnity."})]}),(0,c.jsxs)(s.tr,{children:[(0,c.jsx)(s.td,{children:"pageSize"}),(0,c.jsx)(s.td,{children:(0,c.jsx)("code",{children:"number"})}),(0,c.jsx)(s.td,{children:"specify the number of values downloaded per page (or chunk). Default 1000."})]}),(0,c.jsxs)(s.tr,{children:[(0,c.jsx)(s.td,{children:"cursor"}),(0,c.jsx)(s.td,{children:(0,c.jsx)("code",{children:"string"})}),(0,c.jsx)(s.td,{children:"set the cursor position to start searching from a specific index."})]})]})]}),"\n",(0,c.jsx)(s.hr,{})]})}function h(e={}){const{wrapper:s}={...(0,r.R)(),...e.components};return s?(0,c.jsx)(s,{...e,children:(0,c.jsx)(d,{...e})}):d(e)}}}]);